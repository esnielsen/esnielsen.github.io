[{"authors":null,"categories":[],"content":"Coastal Species Distribution Models This tutorial will discuss how to run Species Distribution Models (SDMs) on coastal species using biomod2 in R.\nWe will obtain the predictor environmental variables from Bio-Oracle with the R package sdmpredictors. Since I work on intertidal species, I want to include both terrestrial and marine environmental variables. We will first load and stack the layers.\nIt is also important to only include variables that are available at both time points you want to model.\nlibrary(sdmpredictors) # Download present day environmental variables #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ #download terrestrial features (Temp_max, Temp_min, Temp_range) terr \u0026lt;- load_layers( layercodes = c(\u0026quot;WC_bio5\u0026quot;, \u0026quot;WC_bio6\u0026quot;, \u0026quot;WC_bio7\u0026quot;) , equalarea=FALSE, rasterstack=TRUE) #download marine features mar \u0026lt;- load_layers( layercodes = c(\u0026quot;MS_biogeo08_sss_mean_5m\u0026quot;, \u0026quot;MS_biogeo13_sst_mean_5m\u0026quot;) , equalarea=FALSE, rasterstack=TRUE) #check the chacteristics of each raster stack terr ## class : RasterStack ## dimensions : 1800, 4320, 7776000, 3 (nrow, ncol, ncell, nlayers) ## resolution : 0.08333333, 0.08333333 (x, y) ## extent : -180, 180, -60, 90 (xmin, xmax, ymin, ymax) ## crs : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 ## names : WC_bio5, WC_bio6, WC_bio7 ## min values : -7.3, -55.5, 5.3 ## max values : 48.9, 25.8, 72.5 mar ## class : RasterStack ## dimensions : 2160, 4320, 9331200, 2 (nrow, ncol, ncell, nlayers) ## resolution : 0.08333333, 0.08333333 (x, y) ## extent : -180, 180, -90, 90 (xmin, xmax, ymin, ymax) ## crs : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 ## names : MS_biogeo08_sss_mean_5m, MS_biogeo13_sst_mean_5m ## min values : -0.05, -2.00 ## max values : 40.43, 30.40 Notice how the two raster stacks have different dimensions. In order to stack our terrestrial and marine rasters, we will need to resample them to have the same dimensions.\n#Resample the marine by the terrestrial layers and stack into one raster stack t\u0026lt;-extent(-180, 180, -90, 90) #layer extent from terrestrial stack m\u0026lt;-extent(-180, 180, -90, 90) #layer extent from marine stack #no need to edit the following 6 lines extent_list\u0026lt;-list(t, m) extent_list\u0026lt;-lapply(extent_list, as.matrix) matrix_extent\u0026lt;-matrix(unlist(extent_list), ncol=length(extent_list)) rownames(matrix_extent)\u0026lt;-c(\u0026quot;xmin\u0026quot;, \u0026quot;ymin\u0026quot;, \u0026quot;xmax\u0026quot;, \u0026quot;ymax\u0026quot;) best_extent\u0026lt;-extent(min(matrix_extent[1,]), max(matrix_extent[3,]), min(matrix_extent[2,]), max(matrix_extent[4,])) ranges\u0026lt;-apply(as.matrix(best_extent), 1, diff) reso\u0026lt;-res(terr) #choose layer you want to keep resolution nrow_ncol\u0026lt;-ranges/reso s2\u0026lt;-raster(best_extent, nrows=nrow_ncol[2], ncols=nrow_ncol[1], crs=terr@crs) #choose layer crs you want to keep t.2 \u0026lt;-resample(terr, s2, method=\u0026quot;ngb\u0026quot;) #resample terr by s2 m.2 \u0026lt;-resample(mar, s2, method=\u0026quot;ngb\u0026quot;) #resample mar by s2 env=stack(t.2, m.2) #stack resampled layers # Set study extent SA.ext \u0026lt;- extent(10, 40, -37, -22) # Crop raster layer by extent \u0026amp; plot env.c \u0026lt;- crop(env, SA.ext) plot(env.c) Plotting the environmental layers should give you a figure such as the above. Now we have a single raster stack called ‘env’. We now need to remove highly correlated environmental variables.\nHere we will need to include our species presence data, which should include three columns: columns 1 \u0026amp; 2: x and y coordinates; column 3: presence (1) or absence (0) at each coordinate.\nTo check for variable collinearity, we will first create a correlation circle, and then calculate the variance inflation factor, or VIF.\n# Filter environmental variables to account for collinearity #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ # Import your presence data and plot pres.data \u0026lt;-read.table(\u0026quot;Cpunctatus.pres2.txt\u0026quot;,sep=\u0026quot;\\t\u0026quot;,header=T) plot(env.c$WC_bio5) points(pres.data[,1:2], pch=19, col=\u0026quot;black\u0026quot;) # Extract env values for our species locations: envdata \u0026lt;- extract(x=env.c, y=cbind(pres.data$x, pres.data$y)) # The `dudi.pca` function allows us to perform the PCA over the whole study area. We decide to keep only 2 principal component axes to summarize the whole environmental niche. NB: here be careful that none of your xy presence points are outside of the environmental raster layer, which will give NA values, which will give errors. library(ade4) pca1 \u0026lt;- dudi.pca(envdata, scannf = F, nf = 2) round(pca1$eig/sum(pca1$eig)*100, 2) ## [1] 54.97 28.58 12.85 3.60 # A preliminary test is to look for potential outliers in the environmental data. plot(pca1$li[,1:2]) # PCA scores on first two axes summary(pca1$li) ## Axis1 Axis2 ## Min. :-5.08541 Min. :-1.6900 ## 1st Qu.:-0.69014 1st Qu.:-0.9985 ## Median :-0.02031 Median :-0.3923 ## Mean : 0.00000 Mean : 0.0000 ## 3rd Qu.: 1.30403 3rd Qu.: 1.0404 ## Max. : 2.52228 Max. : 2.5989 # Plot a correlation circle. s.corcircle(pca1$co) # From the correlation circle, we want to select variables on different axes and not in the same/overlapping environmental space. If there are multiple variables in the same quadrant of the circle, we should choose the one with a longer arrow, as that means it varies more over the environmental space, which is preferred. However, it is also important to know which environmental features are more relevant to your study species, and to choose according to the ecology of each species. # A note on arrow directions: same direction = highly correlated, orthogonal (this means at a 90 degree angle) = unrelated, opposite directions = negatively correlated # From the plot, we can get rid of variable WC_bio6, and plot again VARSEL \u0026lt;- c(\u0026quot;WC_bio5\u0026quot;, \u0026quot;WC_bio7\u0026quot;, \u0026quot;MS_biogeo08_sss_mean_5m\u0026quot;, \u0026quot;MS_biogeo13_sst_mean_5m\u0026quot;) env.c.2 \u0026lt;- stack(subset(env.c, VARSEL)) envdata \u0026lt;- extract(x=env.c.2, y=cbind(pres.data$x, pres.data$y)) pca1 \u0026lt;- dudi.pca(envdata, scannf = F, nf = 2) s.corcircle(pca1$co) #Test correlation with VIF ##Calculate variance inflation factor (VIF). Generally you want to exclude variables with a VIF\u0026gt;10. library(usdm) vif(env.c.2) ## Variables VIF ## 1 WC_bio5 13.712553 ## 2 WC_bio7 5.311111 ## 3 MS_biogeo08_sss_mean_5m 2.367307 ## 4 MS_biogeo13_sst_mean_5m 9.803145 #Since none of our variables have a VIF \u0026gt; 10, we can keep all variables for the SDMs. # We can write the raster stack to save in the home directory. writeRaster(env.c.2, filename=\u0026quot;env.c.2.tif\u0026quot;, format=\u0026quot;GTiff\u0026quot;, overwrite=TRUE) Now that we have our final set of variables, we can download the same variables for the Last Glacial Maximum (LGM), 21,000 years ago. The environmental features from Bio-Oracle automatically include the lowered sea levels at the LGM which is nice.\nIt is generally good practice to include multiple climatic models. Here we will include two models: CCSM4 and MIROC. The oceanic layers are already an ensemble of multiple models, so we will use the ensemble without CCSM with the MIROC terrestrial layers, and the ocean model including CCSM with the CCSM terrestrial layers.\n# Download historical environmental data #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ # Load layers and make sure they are in the same order as your contemporary raster stack (WC_bio5, WC_bio7, SSS, SST) a.miroc.21 \u0026lt;- load_layers(layercodes = c(\u0026quot;WC_bio5_cclgm\u0026quot;, \u0026quot;WC_bio7_cclgm\u0026quot;), equalarea=FALSE, rasterstack=TRUE, datadir=NULL) a.ccsm.21 \u0026lt;- load_layers(layercodes = c(\u0026quot;WC_bio5_mrlgm\u0026quot;, \u0026quot;WC_bio7_mrlgm\u0026quot;), equalarea=FALSE, rasterstack=TRUE, datadir=NULL) o.ens.adj.21 \u0026lt;- load_layers(layercodes = c(\u0026quot;MS_biogeo08_sss_mean_21kya_adjCCSM\u0026quot;, \u0026quot;MS_biogeo13_sst_mean_21kya_adjCCSM\u0026quot;), equalarea=FALSE, rasterstack=TRUE, datadir=NULL) o.ens.nc.21 \u0026lt;- load_layers(layercodes = c(\u0026quot;MS_biogeo08_sss_mean_21kya_noCCSM\u0026quot;, \u0026quot;MS_biogeo13_sst_mean_21kya_noCCSM\u0026quot;), equalarea=FALSE, rasterstack=TRUE, datadir=NULL) a.miroc.21.2 \u0026lt;-resample(a.miroc.21, s2, method=\u0026quot;ngb\u0026quot;) a.ccsm.21.2 \u0026lt;-resample(a.ccsm.21, s2, method=\u0026quot;ngb\u0026quot;) o.ens.adj.21.2 \u0026lt;-resample(o.ens.adj.21, s2, method=\u0026quot;ngb\u0026quot;) o.ens.nc.21.2 \u0026lt;-resample(o.ens.nc.21, s2, method=\u0026quot;ngb\u0026quot;) miroc.21 =stack(a.miroc.21.2, o.ens.nc.21.2 ) ccsm.21 =stack(a.ccsm.21.2, o.ens.adj.21.2 ) miroc.21.crop \u0026lt;- crop(miroc.21, SA.ext) ccsm.21.crop \u0026lt;- crop(ccsm.21, SA.ext) miroc.21.c \u0026lt;- stack(miroc.21.crop) ccsm.21.c \u0026lt;- stack(ccsm.21.crop) writeRaster(miroc.21.c, filename=\u0026quot;miroc.21.tif\u0026quot;, format=\u0026quot;GTiff\u0026quot;, overwrite=TRUE) writeRaster(ccsm.21.c, filename=\u0026quot;ccsm.21.tif\u0026quot;, format=\u0026quot;GTiff\u0026quot;, overwrite=TRUE) We are now ready to run our SDMs, using the package biomod2. We can use our environmental raster stack (for the present day) and presence data to create pseudo-absence data.\nlibrary(biomod2) # Create presence and absence data #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ # Convert the column named \u0026quot;PRESENCE\u0026quot; to a character class myResp\u0026lt;-as.numeric(pres.data$Cpunctatus) myRespName \u0026lt;- \u0026#39;Cpunctatus\u0026#39; # Create presence and pseudo absences SPC_PresAbs \u0026lt;- BIOMOD_FormatingData(resp.var = myResp, expl.var = env.c.2, resp.xy = pres.data[,c(\u0026#39;x\u0026#39;, \u0026#39;y\u0026#39;)], resp.name = myRespName, PA.nb.rep = 3, PA.nb.absences = 10000, PA.strategy = \u0026#39;random\u0026#39;) ## NOTE: if you get an error that looks like this: ## \u0026#39;Error in .BIOMOD_FormatingData.check.args(resp.var, expl.var, resp.xy, : Explanatory variable must be one of numeric, data.frame, matrix, RasterLayer, RasterStack, SpatialPointsDataFrame, SpatialPoints\u0026#39; #Then simply re-create your raster stack and try again. As such: env.c.2 \u0026lt;- stack(env.c.2) SPC_PresAbs \u0026lt;- BIOMOD_FormatingData(resp.var = myResp, expl.var = env.c.2, resp.xy = pres.data[,c(\u0026#39;x\u0026#39;, \u0026#39;y\u0026#39;)], resp.name = myRespName, PA.nb.rep = 3, PA.nb.absences = 10000, PA.strategy = \u0026#39;random\u0026#39;) # Check the number of absences SPC_PresAbs ## Notice how the output here says that there are a different number of pseudo absences than you input in the \u0026#39;PA.nb.absences\u0026#39; parameter. I am guessing this is because the same cell can be chosen as an absence over and over within this step, so I would advise playing with that parameter until you get roughly and equal amount of absences as you have presences. # Plot your pseudo absences plot(SPC_PresAbs) Next we will run model models using our presence and pseudo absence data and environmental features. Here we will run 6 different models, over 10 runs, using 30% of the data for callibration, and 70% for fitting models.\nWe will then check how well the model performs with two separate evalution scores: ROC and TSS. Generally, a ROC \u0026gt; 0.8 and TSS \u0026gt; 0.55 are indicative of high model accuracy.\n# Run BIOMOD Models #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ # Set modeling options (NB: refer to the package vingette for non-default model options) MySpc_options \u0026lt;- BIOMOD_ModelingOptions( GLM = list( type = \u0026#39;quadratic\u0026#39;, interaction.level = 1 ), GBM = list( n.trees = 1000 ), GAM = list( algo = \u0026#39;GAM_mgcv\u0026#39; ) ) # Run the models with specific parameters. MySpc_models \u0026lt;- BIOMOD_Modeling( data = SPC_PresAbs, models = c(\u0026quot;GLM\u0026quot;,\u0026quot;GAM\u0026quot;, \u0026quot;GBM\u0026quot;, \u0026quot;RF\u0026quot;,\u0026quot;MARS\u0026quot;, \u0026quot;FDA\u0026quot;), models.options = MySpc_options, NbRunEval = 10, DataSplit = 70, VarImport = 3, models.eval.meth=c(\u0026#39;TSS\u0026#39;,\u0026#39;ROC\u0026#39;), do.full.models = F ) # Get models evaluation scores #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ MyModels_scores \u0026lt;- get_evaluations(MySpc_models) MyModels_scores[\u0026quot;ROC\u0026quot;,\u0026quot;Testing.data\u0026quot;,,,] MyModels_scores[\u0026quot;TSS\u0026quot;,\u0026quot;Testing.data\u0026quot;,,,] # Graphically see model scores models_scores_graph(MySpc_models, by = \u0026quot;models\u0026quot; , metrics = c(\u0026quot;ROC\u0026quot;,\u0026quot;TSS\u0026quot;), xlim = c(0.5,1), ylim = c(0.5,1)) models_scores_graph(MySpc_models, by = \u0026quot;cv_run\u0026quot; , metrics = c(\u0026quot;ROC\u0026quot;,\u0026quot;TSS\u0026quot;), xlim = c(0.5,1), ylim = c(0.5,1)) models_scores_graph(MySpc_models, by = \u0026quot;data_set\u0026quot; , metrics = c(\u0026quot;ROC\u0026quot;,\u0026quot;TSS\u0026quot;), xlim = c(0.5,1), ylim = c(0.5,1)) We can also look at the importance of each environmental variable in explaining the distribution, which is calculated as the variable importance.\n# Variable importance in models #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ # Calculate variable importance. The higher a score is, the more important is the variable. We will visualize this as a barplot. MyModels_var_import \u0026lt;- get_variables_importance(MySpc_models) dimnames(MyModels_var_import) ## [[1]] ## [1] \u0026quot;WC_bio5\u0026quot; \u0026quot;WC_bio7\u0026quot; ## [3] \u0026quot;MS_biogeo08_sss_mean_5m\u0026quot; \u0026quot;MS_biogeo13_sst_mean_5m\u0026quot; ## ## [[2]] ## [1] \u0026quot;GLM\u0026quot; \u0026quot;GAM\u0026quot; \u0026quot;GBM\u0026quot; \u0026quot;RF\u0026quot; \u0026quot;MARS\u0026quot; \u0026quot;FDA\u0026quot; ## ## [[3]] ## [1] \u0026quot;RUN1\u0026quot; \u0026quot;RUN2\u0026quot; \u0026quot;RUN3\u0026quot; \u0026quot;RUN4\u0026quot; \u0026quot;RUN5\u0026quot; \u0026quot;RUN6\u0026quot; \u0026quot;RUN7\u0026quot; \u0026quot;RUN8\u0026quot; \u0026quot;RUN9\u0026quot; ## [10] \u0026quot;RUN10\u0026quot; ## ## [[4]] ## Cpunctatus_PA1 Cpunctatus_PA2 Cpunctatus_PA3 ## \u0026quot;PA1\u0026quot; \u0026quot;PA2\u0026quot; \u0026quot;PA3\u0026quot; # Average variable importance by algorithm mVarImp \u0026lt;- apply(MyModels_var_import, c(1,2), median) mVarImp \u0026lt;- apply(mVarImp, 2, function(x) x*(1/sum(x))) # standardize the data mVarImp  ## GLM GAM GBM RF MARS ## WC_bio5 0.4021596 0.32975 0.16351286 0.29492455 0.4295490 ## WC_bio7 0.1482750 0.20975 0.11887433 0.09373571 0.1872473 ## MS_biogeo08_sss_mean_5m 0.2201738 0.20675 0.67006308 0.36579790 0.2472784 ## MS_biogeo13_sst_mean_5m 0.2293916 0.25375 0.04754973 0.24554184 0.1359253 ## FDA ## WC_bio5 0.3247801 ## WC_bio7 0.1587243 ## MS_biogeo08_sss_mean_5m 0.3504399 ## MS_biogeo13_sst_mean_5m 0.1660557 #save as table write.table(mVarImp, file=\u0026quot;modelVarImp.txt\u0026quot;, sep=\u0026quot;\\t\u0026quot;, quote = FALSE) It is also good practice to visualize the response curves pertaining to each environmental variable.\n# Response curves #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ # To analyze how each environmental variable influences modelled probability of species presence, we will use an evaluation procedure proposed by Elith et al.(2005). # A plot of these predictions allows visualisation of the modeled response(y-axis) to the given variable (x-axis),conditional to the other variables being held constant. # Here I will show the response curves for the RF model, but you can do for all models: MySpc_rf \u0026lt;- BIOMOD_LoadModels(MySpc_models, models=\u0026#39;RF\u0026#39;) rf_eval_strip \u0026lt;- biomod2::response.plot2( models = MySpc_rf, Data = get_formal_data(MySpc_models,\u0026#39;expl.var\u0026#39;), show.variables= get_formal_data(MySpc_models,\u0026#39;expl.var.names\u0026#39;), do.bivariate = FALSE, fixed.var.metric = \u0026#39;median\u0026#39;, legend = FALSE, display_title = FALSE, data_species = get_formal_data(MySpc_models,\u0026#39;resp.var\u0026#39;)) Now we will project our models onto the current climate, and see how well they predict the current distribution. Running this script will create a folder in your directory called ‘current’. Note that this will automatically overwrite any other folder of the same name.\nAfterwards we will create the ensemble model, which will combine the 6 model types we specified earlier. Here we will use a TSS cut off of 0.55 and ROC cut off of 0.8.\n# Map individual models onto the current Southern African climate #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ MySpc_models_proj_current \u0026lt;- BIOMOD_Projection( modeling.output = MySpc_models, new.env = env.c.2, proj.name = \u0026quot;current\u0026quot;, binary.meth = \u0026quot;ROC\u0026quot;, output.format = \u0026quot;.img\u0026quot;, do.stack = FALSE ) # Plot and compare the maps for the potential current distribution projected by the different models. plot(MySpc_models_proj_current, str.grep=\u0026quot;PA1_RUN1\u0026quot;) # If any of the models over or under estimate the distribution, then you can consider leaving them out of the ensemble model. # Run ensemble models #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ MySpc_ensemble_models \u0026lt;- BIOMOD_EnsembleModeling( modeling.output = MySpc_models, chosen.models =\u0026#39;all\u0026#39;, em.by = \u0026#39;all\u0026#39;, #combine all models eval.metric = \u0026#39;all\u0026#39;, eval.metric.quality.threshold = c(0.55,0.8), models.eval.meth = c(\u0026#39;TSS\u0026#39;,\u0026#39;ROC\u0026#39;), prob.mean = FALSE, prob.cv = TRUE, #coefficient of variation across predictions committee.averaging = TRUE, prob.mean.weight = TRUE, VarImport = 0 ) # Check ensemble scores MySpc_ensemble_models_scores \u0026lt;- get_evaluations(MySpc_ensemble_models) MySpc_ensemble_models_scores # Ensemble model forecast onto current environment #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ MySpc_ensemble_models_proj_current \u0026lt;- BIOMOD_EnsembleForecasting( EM.output = MySpc_ensemble_models, projection.output = MySpc_models_proj_current, binary.meth = \u0026quot;ROC\u0026quot;, #make binary predictions (pres/abs) based on ROC score output.format = \u0026quot;.img\u0026quot;, do.stack = FALSE ) # The projections for current conditions are stored in the \u0026#39;proj_current\u0026#39; directory. get_projected_models(MySpc_ensemble_models_proj_current) # Plot them all plot(MySpc_ensemble_models_proj_current) plot(MySpc_ensemble_models_proj_current, str.grep=\u0026quot;EMcaByTSS\u0026quot;) plot(MySpc_ensemble_models_proj_current, str.grep=\u0026quot;EMwmeanByTSS\u0026quot;) # Ensemble model hindcast onto LGM environment #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ #Fit model using new environmental variables #first we need to re-name the raster stack layers to be the same as the \u0026#39;present-day\u0026#39; raster stack we built the model on names(miroc.21.c) \u0026lt;- c(\u0026#39;WC_bio5\u0026#39;,\u0026#39;WC_bio7\u0026#39;,\u0026#39;MS_biogeo08_sss_mean_5m\u0026#39;, \u0026#39;MS_biogeo13_sst_mean_5m\u0026#39;) #Then project the model onto the new environmental layers MySpc_models_proj_LGM1 \u0026lt;- BIOMOD_Projection( modeling.output = MySpc_models, new.env = miroc.21.c, proj.name = \u0026quot;miroc.LGM\u0026quot;, binary.meth = c(\u0026quot;ROC\u0026quot;), output.format = \u0026quot;.img\u0026quot;, do.stack = FALSE) #Then run hindcasting ensemble model: MySpc_ensemble_models_proj_LGM1 \u0026lt;- BIOMOD_EnsembleForecasting( EM.output = MySpc_ensemble_models, projection.output = MySpc_models_proj_LGM1, binary.meth = \u0026quot;ROC\u0026quot;, output.format = \u0026quot;.img\u0026quot;, do.stack = FALSE, build.clamping.mask=F) # Then do this same for CCSM LGM layers names(ccsm.21.c) \u0026lt;- c(\u0026#39;WC_bio5\u0026#39;,\u0026#39;WC_bio7\u0026#39;,\u0026#39;MS_biogeo08_sss_mean_5m\u0026#39;, \u0026#39;MS_biogeo13_sst_mean_5m\u0026#39;) MySpc_models_proj_LGM2 \u0026lt;- BIOMOD_Projection( modeling.output = MySpc_models, new.env = ccsm.21.c, proj.name = \u0026quot;ccsm.LGM\u0026quot;, binary.meth = c(\u0026quot;ROC\u0026quot;), output.format = \u0026quot;.img\u0026quot;, do.stack = FALSE) MySpc_ensemble_models_proj_LGM2 \u0026lt;- BIOMOD_EnsembleForecasting( EM.output = MySpc_ensemble_models, projection.output = MySpc_models_proj_LGM2, binary.meth = \u0026quot;ROC\u0026quot;, output.format = \u0026quot;.img\u0026quot;, do.stack = FALSE, build.clamping.mask=F) Finally, we can map the outputs of the models to create a single figure in which they are compared. We will first combine the MIROC and CCSM model outputs, by averaging their values per cell. We will also enlargen the cells to make the output maps easier to read.\n## Plotting SDM outputs #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ library(rasterVis) library(gridExtra) library(rgdal) cc = colorRampPalette( c(\u0026quot;red\u0026quot;, \u0026quot;white\u0026quot;,\u0026quot;blue\u0026quot;)) ## Retreive output maps from the different directories MyBinCP_curr \u0026lt;- raster::stack(\u0026quot;Cpunctatus/proj_current/individual_projections/Cpunctatus_EMcaByTSS_mergedAlgo_mergedRun_mergedData.img\u0026quot;) MyBinCP_c.LGM \u0026lt;- raster::stack(\u0026quot;Cpunctatus/proj_ccsm.LGM/individual_projections/Cpunctatus_EMcaByTSS_mergedAlgo_mergedRun_mergedData.img\u0026quot;) MyBinCP_m.LGM \u0026lt;- raster::stack(\u0026quot;Cpunctatus/proj_miroc.LGM/individual_projections/Cpunctatus_EMcaByTSS_mergedAlgo_mergedRun_mergedData.img\u0026quot;) # Load a shapefile to have as a background map SAmap \u0026lt;- readOGR(\u0026quot;Cpunctatus/Africa.shp\u0026quot;) ## OGR data source with driver: ESRI Shapefile ## Source: \u0026quot;/Users/ericaspotswoodnielsen/Desktop/website/SDM.tutorial/Cpunctatus/Africa.shp\u0026quot;, layer: \u0026quot;Africa\u0026quot; ## with 762 features ## It has 3 fields SAmap.c \u0026lt;- crop(SAmap, SA.ext) # Make ensemble outputs combining the miroc and ccsm models (by averaging cell values) CP.mean.LGM \u0026lt;- merge(MyBinCP_c.LGM, MyBinCP_m.LGM) # Aggregate the cells to make the output more visable (this doubles the size of the cells) CP.mean.LGM.agg \u0026lt;- aggregate(CP.mean.LGM, fact=2) MyBinCP_c.agg \u0026lt;- aggregate(MyBinCP_curr, fact=2) CP.sdms \u0026lt;- stack(MyBinCP_c.agg, CP.mean.LGM.agg) names(CP.sdms) \u0026lt;- c(\u0026#39;Current\u0026#39;, \u0026#39;LGM\u0026#39;) levelplot(CP.sdms, col.regions=cc, layout=c(1, 2)) + layer(sp.polygons(SAmap.c, fill=\u0026#39;white\u0026#39;, alpha=0.2)) And here we have the final product, showing the average habitat suitability at two timepoints.\n Thanks for reading and feel free to let me know if you have any questions. Post written by Erica Nielsen, R scripts written by Nikki Phair and Erica Nielsen ~\n   ","date":1585094400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1585094400,"objectID":"5d321f9c8e7e6e7621d0288b6e7b0e11","permalink":"/post/sdms/","publishdate":"2020-03-25T00:00:00Z","relpermalink":"/post/sdms/","section":"post","summary":"Coastal Species Distribution Models This tutorial will discuss how to run Species Distribution Models (SDMs) on coastal species using biomod2 in R.\nWe will obtain the predictor environmental variables from Bio-Oracle with the R package sdmpredictors. Since I work on intertidal species, I want to include both terrestrial and marine environmental variables. We will first load and stack the layers.\nIt is also important to only include variables that are available at both time points you want to model.","tags":[],"title":"SDMs","type":"post"},{"authors":null,"categories":null,"content":"Below is my entry for the 2020 \u0026lsquo;Dance Your PhD\u0026rsquo; video contest created by Gonzo Labs and Science Magazine.\nWith this video I aimed to describe a chapter of my PhD via dance, but also hoped to achieve the following:\n make concepts of population genetics accessible to those with little previous knowledge on the subject\n engage and collaborate with local dance groups to conduct knowledge transfer between the sciences and the arts\n create a unique video that combines my love of dance and science, and have fun while doing it!\n  This project is dedicated to my family, whom I hope understands what my PhD is about after watching this video :)\nEnjoy!\n  ","date":1582295574,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1582295574,"objectID":"9aa4f1ccbd8c2ef93e5867cfa7e3e173","permalink":"/project/dance-your-phd-entry/","publishdate":"2020-02-21T16:32:54+02:00","relpermalink":"/project/dance-your-phd-entry/","section":"project","summary":"My video entry for the 2020 'Dance Your PhD' contest","tags":null,"title":"My Dance Your PhD Entry!","type":"project"},{"authors":null,"categories":[],"content":"This tutorial will go through how to run Species Distribution Models (SDMs) on coastal species using biomod2 in R.\nWe will obtain the predictor environmental variables from Bio-Oracle with the R package sdmpredictors. Since I work on intertidal species, I want to include both terrestrial and marine environmental variables. We will first load and stack the layers.\nIt is also important to only include variables that are available at both time points you want to model.\n Because the terrestrial and marine layers have different dimensions, we will need to resample them so that we can combine them into a single raster stack.\n Plotting the environmental layers should give you a figure such as this:\nNow we have a single raster stack called \u0026lsquo;env\u0026rsquo;. We now need to remove highly correlated environmental variables.\n Here we will need to include our species presence data, which should include three columns: columns 1 \u0026amp; 2: x and y coordinates; column 3: presence (1) or absence (0) at each coordinate.\nTo check for variable collinearity, we will first create a correlation circle, and then calculate the variance inflation factor, or VIF.\nThe correlation circle should look something like this:\nFrom the correlation circle, we want to select variables on different axes and not in the same/overlapping environmental space. If there are multiple variables in the same quadrant of the circle, we should choose the one with a longer arrow, as that means it varies more over the environmental space, which is preferred. However, it is also important to know which environmental features are more relevant to your study species, and to choose according to the ecology of each species.\n A note on arrow directions: same direction = highly correlated, orthogonal (this means at a 90 degree angle) = unrelated, opposite directions = negatively correlated  From the VIF we want to only include variables with a VIF\u0026lt; 10.\nLooking at both the correlation circle, and from the VIFs, we will select the following variables: Tmax, T_range, SSS, and SST. After selecting these variables our correlation circle looks like so:\nNow that we have our final set of variables, we can download the same variables for the Last Glacial Maximum (LGM), 21,000 years ago. The environmental features from Bio-Oracle automatically include the lowered sea levels at the LGM which is nice.\nIt is generally good practice to include multiple climatic models. Here we will include two models: CCSM4 and MIROC. The oceanic layers are already an ensemble of multiple models, so we will use the ensemble without CCSM with the MIROC terrestrial layers, and the ocean model including CCSM with the CCSM terrestrial layers.\n Now we can use our environmental raster stack and presence data to create pseudo-absence data.\n The output maps for the pseudo-absences looks like so:\nNext we will run model models using our presence and pseudo absence data and environmental features. Here we will run 6 different models, over 10 runs, using 30% of the data for callibration, and 70% for fitting models.\n Then we can evaluate the models. We will graph the model scores. A TSS of above ~0.55 and ROC of above ~ 0.8 are indicative of well performing models.\nThe graphs should look similar to this:\nWe can also look at the importance of each environmental variable in explaining the distribution, which is calculated as the variable importance. It is also good practice to visualize the response curves pertaining to each environmental variable.\nNow we will project our models onto the current climate, and compare how well they predict the current distribution. Running this script will create a folder in your directory called \u0026lsquo;current\u0026rsquo;. Note that this will automatically overwrite any other folder of the same name.\nAfterwards we will create the ensemble model, which will combine the 6 model types we specified earlier. Here we will use a TSS cut off of 0.55 and ROC cut off of 0.8.\n The output of our ensemble model looks like so:\nFinally, we can project our models onto future layers. We will first combine the MIROC and CCSM model outputs, by averaging their values per cell. We will also enlargen the cells to make the output maps easier to read.\n Our final figure showing habitat suitability for all models at two timepoints looks like so:\nThanks for reading and feel free to let me know if you have any questions :)\nPost written by Erica Nielsen, R scripts written by Nikki Phair and Erica Nielsen.\n","date":1576454400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1576454400,"objectID":"738f13e28c3fd1b8083c052eed531d1e","permalink":"/post/coastal-species-distribution-models/","publishdate":"2019-12-16T00:00:00Z","relpermalink":"/post/coastal-species-distribution-models/","section":"post","summary":"This tutorial will go through how to run Species Distribution Models (SDMs) on coastal species using biomod2 in R.\nWe will obtain the predictor environmental variables from Bio-Oracle with the R package sdmpredictors. Since I work on intertidal species, I want to include both terrestrial and marine environmental variables. We will first load and stack the layers.\nIt is also important to only include variables that are available at both time points you want to model.","tags":[],"title":"Coastal Species Distribution Models","type":"post"},{"authors":null,"categories":null,"content":"On Nov 4-7th 2019 I had the opportunity to attend The Conservation Symposium, which aims to bring together those working on conservation issues within South Africa.\nI enjoy this conference because it takes me out of my academia bubble and transports me into the ‘on the ground’ conservation practice realm. Students and academics make up a small portion of the attendees, outnumbered by NGOs, consulting companies, government organizations, attorneys, reporters, and filmmakers.\nThe main theme that struck me throughout this conference is the need to understand the human dimension to ensure effective conservation planning and management. Below I discuss a few of the key insights I had in relation to this topic.\n This year they had the first ever session dedicated to indigenous knowledge (IK) in conservation. It was interesting to see how as a country we are actually quite ahead of the game in the inclusion of IK in conservation publications. But the thing that irked me during this session was that the audience laughed at almost all mentions of local taboos (an example of which is that some indigenous people believe that touching a certain tree species causes women to immediately start menstruating). I think this demonstrates how far we have yet to go in reframing our mindsets to see conservation not from a typical westernized view, but from a more inclusive, open-minded framing.\n I also noted how all of the IK-related talks were in a terrestrial setting. I searched ‘South Africa indigenous knowledge marine’ in Web of Science and found zero papers investigating the use of IK in marine conservation. But, this made me remember an interesting poster at this year’s WIOMSA symposium where they interviewed local fishers along the South African coastline asking if water temperatures were changing, and reported areas where fishers’ knowledge differed from temperature changes monitored by scientists. We still have a long way to go with integrating IK into conservation management, and I think we will see a lot more marine conservation studies incorporating aspects of local communities in the near future.\n This year the symposium also introduced the Conservation Café, which involved youth-led discussions on conservation topics chosen by young (\u0026lt;35 yrs) attendants. During the tea breaks, we wrote on a white board what we wanted to discuss or added stars next to those topics on the board that we were interested in (seen in pictures below). In the session I went to, we talked again about IK within conservation, but also about capitalism and the goal of conservation. It was a lot of discussing problems, but one of the solutions I took away was that as youth we need to use our voices on social media, and also broaden our social circles in real life (or IRL as the kids say these days) to actively ‘market’ sustainable lifestyles and ‘make conservation cool again’.\n Lastly, there were some very interesting talks on how people perceive our parks within the country. Nyiko Mutileni gave a talk on her work where she interviewed local communities just a few km outside of Man’ombe Nature Reserve, asking if they have every entered the reserve, and if they benefit from the reserve. Many local people had never even heard of the park, only ~3% had entered the park, and most believed they did not benefit from the park because they could no longer access natural resources. Another talk by Dr Izak Smit described how he interviewed visitors of Kruger National Park to understand how they perceived conservation. Most visitors do not believe that conservation areas should be focused on making money, or that we humans should actively manage nature through ‘harsh’ management such as culling. But most surprising to me was almost half of the interviewees believe that humans are separate from nature rather than interconnected through ecological processes. Dr Smit mentioned how this is partly driven by the fact that while 1.9 million people visit Kruger annually, only ~1% actually get out of their cars, walk in the bush, and physically connect with nature. Our disconnect with the natural world is a major issue of our time (shown by the fact that I had to mention ‘in real life’ in the previous point), and protected areas will be fundamental to our individual and societal resilience as we face ever increasing uncertainties on this Earth.\n  ","date":1576333974,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1576333974,"objectID":"349b2ccdbfcd467f6d9f1cca4d9203e6","permalink":"/project/sccp_2019/","publishdate":"2019-12-14T16:32:54+02:00","relpermalink":"/project/sccp_2019/","section":"project","summary":"On Nov 4-7th 2019 I had the opportunity to attend The Conservation Symposium, which aims to bring together those working on conservation issues within South Africa.\nI enjoy this conference because it takes me out of my academia bubble and transports me into the ‘on the ground’ conservation practice realm. Students and academics make up a small portion of the attendees, outnumbered by NGOs, consulting companies, government organizations, attorneys, reporters, and filmmakers.","tags":null,"title":"2019 Conservation Symposium Review","type":"project"},{"authors":null,"categories":null,"content":"Below is my entry to the Youth4Conservation video contest for the 2019 South African Conservation Symposium.\nThe Youth4Conservation movement partners young volunteers with local conservation organisations to help tackle critical conservation issues within South Africa.\nThis year, the Conservation Symposium partnered with WildTrust, offering discounted registration prices to young attendees who send a short video describing how they are contributing to conservation within South Africa.\nWith this video, I hope to share why genetics and genomics are important to conserving biodiversity, especially with regards to an uncertain climatic future.\nEnjoy!\n  ","date":1569162774,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1569162774,"objectID":"65c075cb5fba0c97012aaaa332a8c5a5","permalink":"/project/youth4cons/","publishdate":"2019-09-22T16:32:54+02:00","relpermalink":"/project/youth4cons/","section":"project","summary":"My video entry for the Conservation Symposium's Youth4Conservation award","tags":null,"title":"Youth 4 Conservation","type":"project"},{"authors":null,"categories":null,"content":"During July 1-5 2019, I attended the 11th Western Indian Ocean Marine Science Association (WIOMSA) symposium at the University of Mauritius with two of my colleagues Nikki and Molly.\nWIOMSA is always a great conference as it covers a variety of scientific disciplines and has a strong focus on integrating research and management within the region. Some of the highlights were:\n Prof Golden’s plenary which discussed the impacts of climate change on small-scale fisheries and human nutrition. Here we were shown which countries were most vulnerable to malnutrition due to declined marine catches, and also which fish species are ideal candidates for aquaculture within these countries based on their sustainability and nutritional value.\n Prof Dupont’s plenary which discussed the vast and complex implications of ocean acidification. Prof Dupont proved how science communication can make something intangible, such as ocean acidification, tangible, by offering shrimp tastings where people could actually taste the difference between seafood raised in normal or low pH conditions.\n The science communication mini-symposium, as well as the multiple videos that were shown during the conference (including the following: mzansi \u0026amp; kokoly)\n The Women In Science speed dating lunch where we discussed actions we could take to improve gender equality in the context of marine conservation within the region. We highlighted the need for more information sharing via face-to-face and online, increase position papers on women in small scale fisheries, and fundraise campaigns for projects that specifically support women and communities in the region.\n The exciting discoveries and opportunities regarding the deep and open ocean. With increasing off-shore threats such as mining, we will soon need to move towards ‘high-seas’ protected areas, which should be biologically meaningful instead of simply reaching a target % of the ocean. There were multiple talks on how new technology is allowing us to assess the biodiversity of seamounts and deep-water canyons, and results suggest that these areas should be considered for MPAs outside of EEZs.\n The multiple talks on social resilience, which highlighted how social adaptive capacity is space and time specific, and needs to be conducted on different gender groups and throughout different seasons. I also thought it was interesting how social resilience was qualified, by using questionnaires that asked questions such as ‘Do you think about the future?’.\n I also enjoyed the posters and talks that showed how surfers and kitesurfers can be used to monitor oceanographic features, often by putting cameras/sensors onto boards.\n Last but not least, we each took our turn identifying and mitigating threats such as dynamite fishing in a virtual reality diving game!\n  ","date":1544797974,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1544797974,"objectID":"9ca8af7428def52f9eb8762b4407ea43","permalink":"/project/wiomsa/","publishdate":"2018-12-14T16:32:54+02:00","relpermalink":"/project/wiomsa/","section":"project","summary":"During July 1-5 2019, I attended the 11th Western Indian Ocean Marine Science Association (WIOMSA) symposium at the University of Mauritius with two of my colleagues Nikki and Molly.\nWIOMSA is always a great conference as it covers a variety of scientific disciplines and has a strong focus on integrating research and management within the region. Some of the highlights were:\n Prof Golden’s plenary which discussed the impacts of climate change on small-scale fisheries and human nutrition.","tags":null,"title":"2019 WIOMSA Symposium Review","type":"project"},{"authors":null,"categories":null,"content":"Below is my entry to the Evolution Film Contest.\n_\nEvery year our university opens its doors to high school students, so that they can get an idea of what postgraduates do within each lab. My intention with this video is to open our lab doors to a much wider audience and offer a view into my world as a PhD student studying conservation genetics. I wanted to make a video that is not only fun to watch, but also describes the basic theories and methodologies used within molecular ecology. I also wanted to highlight different sub-divisions of genetics so that viewers can get a sense of the diversity within the field.\nUltimately my hope is that genetics will not longer be a topic that \u0026ldquo;Students Just Don\u0026rsquo;t Understand\u0026rdquo; * wink wink to my Fresh Prince fans *\nThis video could not have happened without the support of my supervisor, fellow lab members, and Stellenbosch University. And special thanks to all those who agreed to wiggle in front of the camera!\nEnjoy and feel free to comment!\n_\n  ","date":1544797974,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1544797974,"objectID":"96e39ab57a5dc4b5c7f7df8b1440a680","permalink":"/project/getgenetic/","publishdate":"2018-12-14T16:32:54+02:00","relpermalink":"/project/getgenetic/","section":"project","summary":"My entry to the 2019 Evolution Film Contest","tags":null,"title":"Get Genetic With It","type":"project"},{"authors":null,"categories":null,"content":"Today civil, political and business leaders are meeting at the UN Climate Action Summit to address the global climate emergency. Ultimately, in order to reduce emissions by 45% by 2030, we will need large corporations and governments to take the lead to ensure that ongoing global development shifts from fossil fuels to renewable energy.\nBut while it is mainly a handful of companies that are responsible for 71% of greenhouse gas emissions, we as individuals and consumers can also fight towards and create a more sustainable future. As the lovel figure above by Ashley Lukashevsky shows, we are all in this together, and together we will rise.\nTherefore, this multi-media post is an ode to small, sustainable actions. And it is important that this is at no means and exhaustive list, and everyone has their own passions and actions that they are attracted to. In the end, the greatest thing we can do is start a conversation on sustainability, as this is the best way to discover new and exciting ways we can transform our society.\nFirst, here is a fun little song I wrote with the intention spreading the idea of sustainability in a way that is hopefully catchy and creative.\n  Then there is the TED talk which I found really interesting, and pointed out many \u0026lsquo;Sustainability Myths\u0026rsquo; that I was previously ignorant of.\nI was also recently ignorant of the CO2 emissions of the internet, until I stumbled upon this lovely infographic. You can also switch your browser from Google to Ecosia.\nThere are also many monetary ways to achieve a lower carbon footprint. One of my favorite new ways is with micro-funding. Find out how you can give micro-loans to green initiatives with Kiva.\nBut maybe these actions seem like they will take too much time and energy to implement. No need to fret, the UN has some actions even the laziest of us can do to become more sustainable: find them here.\nAnd here are a few random ways that I came up with to reduce my footprint:\n Floss- it\u0026rsquo;s reusable! Floss strings can we washed after use, and are effective at getting out gunk after multiple washes.\n If you are like me you loose hairbands and bobbi-pins all the time. Good news is that over people seem to too! I haven\u0026rsquo;t bought a new hair tie in years by picking them up off the ground instead.\n Dido to the above with pens.\n Learn to be good at mooching off other people! I am still learning to ditch my Ego and ask people to give me off-cuts of their plants, my friends to share clothes with me, my neighbour to lend me their food processor, and my surfing buddies to share their sunscreen. The more we share, the less we buy, and the less we waste. But remember to return the favor and actively share with others!\n Go to the bathroom in nature. I swear, there is no better feeling than doing a number 2 outside and having it become beautiful fertilizer.\n Actively try to get outside of your normal social circles. Go to random events, or places where you feel uncomfortable. Have conversations with people with different mindsets. I like to say, \u0026ldquo;I want to live a life that algorithms wouldn\u0026rsquo;t be able to predict.\u0026rdquo;\n Spend time alone, get to know and love yourself. This may seem like a bit of a stretch, but I think the more we get to know ourselves, the less we need material goods to make us happy, and the less we stress over work and things that maybe aren\u0026rsquo;t important in the \u0026lsquo;bigger picture\u0026rsquo;.\n Volunteer. Swerve for deers. Don\u0026rsquo;t use buds to clean your ears. Talk to those with more or less years. Feel emotions and allow yourself tears. But more than anything, don\u0026rsquo;t become indifferent due to your fears.\n  Lastly, I would like to end with a quote by Anne Marie Bonneau said, \u0026ldquo;We don\u0026rsquo;t need a handful of people doing zero waste perfectly. We need millions of people doing it imperfectly\u0026rdquo;.\nThanks for reading!\n","date":1536330774,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1536330774,"objectID":"6d302a203a90b465ff5f7a281ab567f8","permalink":"/project/sustainability/","publishdate":"2018-09-07T16:32:54+02:00","relpermalink":"/project/sustainability/","section":"project","summary":"Thoughts, musings, and music about sustainability","tags":null,"title":"A Sustainable Future","type":"project"},{"authors":null,"categories":null,"content":"Designing Marine Protected Areas, or MPAS, can be difficult, and we still have a lot to learn - as beautifully portrayed in the comic above by Anju Sabu.\nThere are complex and dynamic social-ecological systems that need to be weighed and balanced to create an arrangement of MPAs that best protect the natural environment, and provide for various cultural and economic uses of marine resources.\nBut, we have come a long way in understanding how to best create this balance, often using spatial planning concepts, which this video by Jennifer McGowan does a superb job at explaining:\n  However, as scientists, we often like to take simple concepts like targeting representation in MPAs, and make it more complex.\nThis is described in an Epistle by the conservation planning guru Prof Hugh Possingham:\n__\n\u0026ldquo;The Lame-duck Conservation Principle\nRemember the good old days when conservation planning was just two main principles – adequacy and representation? It seems so simple and logical. But at some point we lost sight of the importance of representation, the simple notion of protecting a sample of everything in a well-managed protected area. What happened?\nIn theory, representation is still at the top of the international conservation agenda, it gets a solid mention in Aichi Target 11, which states:\n\u0026lsquo;By 2020, at least 17 percent of terrestrial and inland water areas and 10 percent of coastal and marine areas, especially areas of particular importance for biodiversity and ecosystem services, are conserved through effectively and equitably managed, ecologically representative and well-connected systems of protected areas and other effective area-based conservation measures, and integrated into the wider landscape and seascape.\u0026rsquo;\nThe Nature Conservancy has championed the cause of representation, with representation and resilience forming the core principles of our new protect land and water strategy. But the rest of the world seems to have lost interest.\nIn my simple mind, The Nature Conservancy is the \u0026lsquo;habitat organisation.\u0026rsquo; That is why I joined. We focus on how to make more quality habitat, in all its forms, because it delivers benefits for people and nature. So it is only logical that we always return to a strong focus on habitat representation.\nYet while we continue to keep our eye on the ball, some organisations and groups believe that a focus on threatened species, via Key Biodiversity Areas, is the best way to prioritisation protection. Others are pushing connectivity as the most important conservation principle — let’s connect the Yukon to Yellowstone. I agree that both are important, but still very much secondary to the notion of protecting a representative sample of habitats or ecosystems.\nWhy are we losing this marketing campaign? In my opinion, representation is on the backburner because it is intellectually a little dull. Connectivity captures the imagination of many scientists, it can be measured by 100 different metrics, while ideas like \u0026lsquo;corridors\u0026rsquo; seem to capture the hearts and minds of the public and politicians. I love connectivity, but I am convinced it is a secondary issue. And, of course, threatened species are all so sexy — with their big brown eyes— much sexier than a place like the mallee woodland (my favourite habitat in Australia).\nSo here’s my challenge to you: Representation is the most boring but important concept in conservation. So how to we make it sexy again?\u0026rdquo;\n__\nI have been thinking of Prof Possingham\u0026rsquo;s question of how do we make the simple act of targeting representation sexy - and I think the answer comes down to making representation a surrogate for adaptability.\nI would argue that nothing is sexier in conservation science at the moment than prioritising areas that are more resilient to climate change. My work specifically looks at areas that are more genetically diverse, and thus assumed to be more resilient to environmental change. And interestingly, there have been several recent publications that suggest that by representing different habitat types (or different species distributions), you are also capturing genetic diversity.\nYou can find such papers in the links below:\n Geographical surrogates of genetic variation for selecting island populations for conservation\n Environmental and geographic variables are effective surrogates for genetic variation in conservation planning\n Incorporating evolutionary processes into conservation planning using species distribution data: a case study with the western Mediterranean herpetofauna: Evolutionary processes in conservation planning\n Testing large-scale conservation corridors designed for patterns and processes: comparative phylogeography of three tree species\n  But of course, this is science, so here is this paper arguing the opposite:\n On the validity of habitat as a predictor of genetic structure in aquatic systems: a comparative study using California water beetles  I think the argument of representative habitats as surrogates of species and genetic diversity could help bring this elegant practice back in the forefront of conservation planning, but I think it will also require scientists to change our perspective of our work, as to not think about how well our work will publish, but how well it can be applied to \u0026lsquo;real-world\u0026rsquo; conservation practice.\nSo really we need a whole paradigm shift within Academia\u0026hellip; but for now let\u0026rsquo;s just settle with a haiku about representation in conservation planning:\n~\nMPA designs,\nTo make easier target:\nRepresentation\n~\nThanks for reading!\n","date":1536330774,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1536330774,"objectID":"6948b51fb1cb263b4b2ffc9ed99fb28b","permalink":"/project/respresentation/","publishdate":"2018-09-07T16:32:54+02:00","relpermalink":"/project/respresentation/","section":"project","summary":"A case for habitat representation in 21st century conservation planning","tags":null,"title":"Representation","type":"project"},{"authors":null,"categories":null,"content":"I have always loved Cindi Lauper\u0026rsquo;s style and her iconic song, \u0026lsquo;Girls just want to have fun\u0026rsquo;, and when I saw this photo (see above) from the Women\u0026rsquo;s March, I knew I needed to make my own rendition of the song. I hope you enjoy!\n  I originally learned how to play the song on the ukulele following this tutorial. The lyrics and tabs below:\n__\nWomen in STEM\n[F] When you ask some girls, what’s a cool career [Dm] They say being an ecologist or an engineer [Bb] Or maybe in psychology or neuroscience, [Dm] Some girls, [C*] just want to do [Bb] science, [Dm] Some girls [C] just want to be [F] scientists,\n[F] I know there’s still discrimination [Dm] But don’t let it stop you from a career in STEM [Bb] Follow your dreams is what I urge [Dm] Some girls [C*] just want to do [Bb] research, [Dm] So we’re going to [C] pursue [F] research\n[F] Ya that\u0026rsquo;s all we really want [Dm] Some funding [F] To run experiments [Dm] And make [C*] infer- [Bb] ences [Dm] Ya to [C] help [F] society\n[F] Make a lab with lots of diversity [Dm] Including women and minorities [Bb] You don’t have to look far, you don\u0026rsquo;t have to search [Dm] And it will make [C*] for better [Bb] research, [Dm] Ya and makes for [C] better [F] researchers\n[F] Ya that\u0026rsquo;s all we really want [Dm] Some funding [F] To run experiments [Dm] And make [C*] infer- [Bb] ences [Dm] Ya to [C] help [F] society\n__\nIf you want to hear more about diversity and women in STEM you can:\n watch this TED talk\n read this article on diversity in academia\n listen to this podcast which highlights how diversity in academia leads to heightened creativity\n read this article on women in conservation!\n  ","date":1536330774,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1536330774,"objectID":"0e6a0539b55f9e79dae7700640691421","permalink":"/project/women-in-stem/","publishdate":"2018-09-07T16:32:54+02:00","relpermalink":"/project/women-in-stem/","section":"project","summary":"Girls just want to have FUN-ding for scientific research.","tags":null,"title":"Women in STEM","type":"project"},{"authors":null,"categories":[],"content":"As Pooled sequencing gains popularity in the world of genomics, more and more programs are being introduced to specifically handle Pool-seq data. However, for students such as myself, it can be difficult to find the right program for each step of the bioinformatics process, and to know the correct data format and parameters used with each individual program.\nHere is a short recap of the Pool-seq bioinformatic programs that I have gathered, including input and output files, and any additional notes I had on the program.\n~\nPopoolation -\ninput: a samtools pileup file (Note: must be made by samtools version 0.1.18 and below, and cannot take mpileup files)\noutput: a pool-specific sync file, from which population specific diversity indices (such at Tajima\u0026rsquo;s pi \u0026amp; D, Watterson\u0026rsquo;s theta) can be calculated with the Variance-sliding.pl\nPopoolation2 -\ninput: a samtools mpileup file (Note: must be made by samtools version 0.1.18 and below)\noutput: a sync file including multiple pools, from which diversity metrics (FSTs) can be calculated. The sync file can also be converted into a genepop file for further analysis.\nNotes of Popoolation/Polpoolation2:\nThe sync2GenePop conversion step requires custom scripts to be written so that it can be run on all loci at once, instead of each locus individually. Feel free to contact me if you wish to see perl scripts used to create a GenePop file for an entire pool.\npoolfstat -\ninput: a sync file from Popoolation2, VCF file, Baypass or Selestim input files\noutput: global and per-SNP FST values, a pairwise FST matrix, Baypass or Selestim input files\nNotes: If you would like to have confidence intervals for poolfstat pairwise FST values, feel free to email me and I can send through custom written bash/R scripts. Also remember that the poolsize list is haploid!\nBayPass -\ninput: 1. pooled read count data, 2. poolsize file, 3. population name file (all of which can be output by poolfstat R package)\noutput: This program is used to find either FST-based or environmental-based outlier loci.\nIf you want FST-based outliers, you would run the core model. Then run the R code under section 5.1.1 of the manual. Then you will generate a POD genofile with the \u0026lsquo;simulate.baypass\u0026rsquo; R script, which you will use as the input in another core model. Then you will compare the outputs of the 2 core model runs with the XTX calibration R scripts.\nIf you want environmental-based outliers, then you would run the auxiliary model. This will give you an \u0026lsquo;summary_betai\u0026rsquo; output file. Within this file, if the BF(dB) column has a value \u0026gt; 20, then you that locus can be identified as an outlier, corresponding to the given environmental predictor in the first column.\nIf you need any help with BayPass, I am happy to share my scripts upon request.\nFreeBayes -\ninput: BAM files \u0026amp; a reference fasta file\noutput: a pool VCF file\nCRISP -\ninput: BAM files, pool sample sizes, reference fasta file (NB: requires at least 2 pools/2 BAM files)\noutput: a pool VCF file\nSNVer -\ninput: BAM files \u0026amp; a text file with the BAM file names, number of haploids, number of samples, and filtering thresholds\noutput: a pool VCF file\nNotes on FreeBayes, CRISP \u0026amp; SNVer:\nEven though these programs make VCF files, I personally could not find a way to convert these VCF files to other formats such as genepop/genind/genlight with conversion tools such as PGDspider, vcf2genepop, or genomic_converter. However, it seems like it can be input into the R package poolfstat to calculate F-statistics, and be converted into files for BayPass and SelEstim.\nSNAPE-pool -\ninput: a samtools pileup file (not mpileup)\noutput: allele frequency output files\nnpstat -\ninput: a samtools mpileup file + individual BAM files (per pool). Can also take GFF3 annotations to perform McDonald-Krietman tests.\noutput: population specific diversity indices (such at Tajima\u0026rsquo;s pi \u0026amp; D, Watterson\u0026rsquo;s theta), and population differentiation (FSTs)\nSNPgenie -\ninput: a VCF file (for a single pool), a reference fasta file, and GTF annotation file\noutput: πN/πS, dN/dS, and other evolutionary parameters (has a great number output files)\nNote: This program is only for model species with annotated genomes.\nPCAdapt -\ninput: a frequency matrix with n rows and L columns (where n is the number of populations and L is the number of genetic markers)\noutput: several plots and list of potential outlier loci\nNote: For my data, this program suggested quite a large number of putative outliers, especially compared to Bayescan, Loistan, and Popoolation.\nSelEstim -\ninput: an allele/read count file\nouput: a \u0026lsquo;delta\u0026rsquo; output file which is input in R to identify outlier loci\nNote: I personally tried SelEstim with ~ 8,000 loci, and the program ran for about 4 weeks without finishing, so could not use due to time restraints.\nPool-hmm -\ninput: a samtools mpileup (Note: the mpileup command should not have -u or -g option)\noutput: allele frequency spectrum, plus probability of \u0026ldquo;Neutral\u0026rdquo;, \u0026ldquo;Intermediate\u0026rdquo; and \u0026ldquo;Selection\u0026rdquo; for each polymorphic site, with additional stats files\n~\nAdditionally, here is a short list of some pipelines available for Pool-seq \u0026amp; non-model organisms:\nPool-party\ndDocent\nGATK\nSTACKS\nAlso, for complete bioinformatics beginners, Galaxy is a great way to understand various bioinformatic programs and their command lines.\n~\nHappy analysing!\n","date":1536278400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1536278400,"objectID":"c9ed5ef0a89702b1212cbd56345a94ab","permalink":"/post/a-guide-to-ngs-pool-seq-programs/","publishdate":"2018-09-07T00:00:00Z","relpermalink":"/post/a-guide-to-ngs-pool-seq-programs/","section":"post","summary":"As Pooled sequencing gains popularity in the world of genomics, more and more programs are being introduced to specifically handle Pool-seq data. However, for students such as myself, it can be difficult to find the right program for each step of the bioinformatics process, and to know the correct data format and parameters used with each individual program.\nHere is a short recap of the Pool-seq bioinformatic programs that I have gathered, including input and output files, and any additional notes I had on the program.","tags":[],"title":"Pool-seq Programs for Population Genomics","type":"post"},{"authors":null,"categories":null,"content":"\u0026hellip;\n","date":1530136800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1530136800,"objectID":"18d05a63a1c8d7ed973cc51838494e41","permalink":"/privacy/","publishdate":"2018-06-28T00:00:00+02:00","relpermalink":"/privacy/","section":"","summary":"\u0026hellip;","tags":null,"title":"Privacy Policy","type":"page"},{"authors":["ES Nielsen","R Henriques","RJ Toonen","ISS Knapp","B Guo","S von der Heyden"],"categories":null,"content":"","date":1525125600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1525125600,"objectID":"5cec0ce6e082b377c504bc66cdf990c5","permalink":"/publication/person-re-identification/","publishdate":"2018-05-01T00:00:00+02:00","relpermalink":"/publication/person-re-identification/","section":"publication","summary":"Genomic tools are increasingly being used on non-model organisms to provide insights into population structure and variability, including signals of selection. However, most studies are carried out in regions with distinct environmental gradients or across large geographical areas, in which local adaptation is expected to occur. Therefore, the focus of this study is to characterize genomic variation and selective signals over short geographic areas within a largely homogeneous region. To assess adaptive signals between microhabitats within the rocky shore, we compared genomic variation between the Cape urchin (Parechinus angulosus), which is a low to mid-shore species, and the Granular limpet (Scutellastra granularis), a high shore specialist. Using pooled restriction site associated DNA (RAD) sequencing, we described patterns of genomic variation and identified outlier loci in both species. We found relatively low numbers of outlier SNPs within each species, and identified outlier genes associated with different selective pressures than those previously identified in studies conducted over larger environmental gradients. The number of population-specific outlier loci differed between species, likely owing to differential selective pressures within the intertidal environment. Interestingly, the outlier loci were highly differentiated within the two northernmost populations for both species, suggesting that unique evolutionary forces are acting on marine invertebrates within this region. Our study provides a background for comparative genomic studies focused on non-model species, as well as a baseline for the adaptive potential of marine invertebrates along the South African west coast. We also discuss the caveats associated with Pool-seq and potential biases of sequencing coverage on downstream genomic metrics. The findings provide evidence of species-specific selective pressures within a homogeneous environment, and suggest that selective forces acting on small scales are just as crucial to acknowledge as those acting on larger scales. As a whole, our findings imply that future population genomic studies should expand from focusing on model organisms and/or studying heterogeneous regions to better understand the evolutionary processes shaping current and future biodiversity patterns, particularly when used in a comparative phylogeographic context.","tags":[],"title":"Complex signatures of genomic variation of two non-model marine species in a homogeneous environment","type":"publication"},{"authors":null,"categories":null,"content":"Embed your slides or video here using shortcodes. Further details can easily be added using Markdown and $\\rm \\LaTeX$ math code.\n","date":1483221600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1483221600,"objectID":"cd6d9d084287506b4668ad90c6aff50a","permalink":"/talk/example-talk/","publishdate":"2017-01-01T00:00:00+02:00","relpermalink":"/talk/example-talk/","section":"talk","summary":"Embed your slides or video here using shortcodes. Further details can easily be added using Markdown and $\\rm \\LaTeX$ math code.","tags":[],"title":"Example Talk","type":"talk"},{"authors":["ES Nielsen","M Beger","R Henriques","KA Selkoe","S von der Heyden"],"categories":null,"content":"","date":1483221600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1483221600,"objectID":"caae70970030052c8f733b2ca8421a2b","permalink":"/publication/clothing-search/","publishdate":"2017-01-01T00:00:00+02:00","relpermalink":"/publication/clothing-search/","section":"publication","summary":"Growing threats to biodiversity and global alteration of habitats and species distributions make it increasingly necessary to consider evolutionary patterns in conservation decision making. Yet, there is no clear-cut guidance on how genetic features can be incorporated into conservation-planning processes, despite multiple molecular markers and several genetic metrics for each marker type to choose from. Genetic patterns differ between species, but the potential trade-offs among genetic objectives for multiple species in conservation planning are currently understudied. We compared spatial conservation prioritizations derived from 2 metrics of genetic diversity (nucleotide and haplotype diversity) and 2 metrics of genetic isolation (private haplotypes and local genetic differentiation) in mitochondrial DNA of 5 marine species. We compared outcomes ofconservation plans based only on habitat representation with plans based on genetic data and habitat representation. Fewer priority areas were selected for conservation plans based solely on habitat representation than on plans that included habitat and genetic data. All 4 genetic metrics selected approximately similar conservation-priority areas, which is likely a result of prioritizing genetic patterns across a genetically diverse array of species. Largely, our results suggest that multispecies genetic conservation objectives are vital to creating protected-area networks that appropriately preserve community-level evolutionary patterns.","tags":[],"title":"Multispecies genetic objectives in spatial conservation planning","type":"publication"}]