<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title></title>
    <link>https://esnielsen.github.io/</link>
    <description>Recent content on </description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy; 2018</copyright>
    <lastBuildDate>Sun, 15 Oct 2017 00:00:00 -0700</lastBuildDate>
    <atom:link href="/" rel="self" type="application/rss+xml" />
    
    <item>
      <title>GeeklyEDU Biology Videos</title>
      <link>https://esnielsen.github.io/project/geeklyedu/</link>
      <pubDate>Tue, 03 Aug 2021 16:32:54 +0200</pubDate>
      
      <guid>https://esnielsen.github.io/project/geeklyedu/</guid>
      <description>&lt;p&gt;In the time between completing my PhD and starting my postdoc, I was doing some freelance science communication work (which I found on the &lt;a href=&#34;https://www.upwork.com/&#34; target=&#34;_blank&#34;&gt;UpWork&lt;/a&gt; site for anyone interesting in freelance work).&lt;/p&gt;

&lt;p&gt;One of the jobs I had was creating ~5 minute videos explaining biology topics at the first-year university level. To see some of my work, click on the links below!&lt;/p&gt;

&lt;p&gt;
&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/2J2MGadq7_w&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;/p&gt;

&lt;p&gt;
&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/3wjQotGU5nc&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;/p&gt;

&lt;p&gt;
&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/jZTGZex2vBU&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;/p&gt;

&lt;p&gt;
&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/FE-Vfdw8X-0&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;/p&gt;

&lt;p&gt;
&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/VnuVkZKwhh0&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;/p&gt;

&lt;p&gt;
&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/Oguc4kiPrDU&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;/p&gt;

&lt;p&gt;
&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/8wCym6qjOws&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;/p&gt;

&lt;p&gt;
&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/7-8roJ4y2SM&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;/p&gt;

&lt;p&gt;
&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/NUcxXsXCKQ4&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;/p&gt;

&lt;p&gt;
&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/yWEfxiNPc64&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;/p&gt;

&lt;p&gt;
&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/0HjW4lzPHBc&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;/p&gt;

&lt;p&gt;
&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/tquU9hRzJh4&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;/p&gt;

&lt;p&gt;
&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/vGGMogMJgaQ&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;/p&gt;

&lt;p&gt;
&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/hIGVEwUPlec&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;/p&gt;


&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/8PI1WtS296M&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

</description>
    </item>
    
    <item>
      <title>Distinct interspecific and intraspecific vulnerability of coastal species to global change</title>
      <link>https://esnielsen.github.io/publication/gcb.2021/</link>
      <pubDate>Sun, 01 Aug 2021 00:00:00 -0700</pubDate>
      
      <guid>https://esnielsen.github.io/publication/gcb.2021/</guid>
      <description></description>
    </item>
    
    <item>
      <title>Pool-Seq Analyses: PoolFstat &amp; BayPass</title>
      <link>https://esnielsen.github.io/post/pool-seq-analyses-poolfstat-baypass/</link>
      <pubDate>Sun, 06 Dec 2020 00:00:00 +0000</pubDate>
      
      <guid>https://esnielsen.github.io/post/pool-seq-analyses-poolfstat-baypass/</guid>
      <description>&lt;div id=&#34;population-structure-outlier-detection-for-pool-seq-data&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Population structure &amp;amp; outlier detection for Pool-seq data&lt;/h2&gt;
&lt;p&gt;This tutorial will discuss how to call SNPs and assess population structure from Pool-Seq data. Specifically, it will go through how to take a sync file from Popoolation, call SNPs with PoolFstat, filter SNPs to account for linkage disequilibrium, and infer population differentiation and identify outliers with BayPass.&lt;/p&gt;
&lt;p&gt;To start, we need a sync file, which I generated using &lt;a href=&#34;https://sourceforge.net/p/popoolation2/wiki/Manual/&#34;&gt;Popoolation2&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;We will use this as the input for &lt;a href=&#34;https://cran.r-project.org/web/packages/poolfstat/poolfstat.pdf&#34;&gt;PoolFstat&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Note in all of the scripts below I will have the heading ‘SG’ just to indicate the species name.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;################################# USING POOLFSTAT ###############################
##################################################################################

library(poolfstat)
library(&amp;quot;WriteXLS&amp;quot;)

##### Convert sync file to poolfstat file, and call SNPS

# We first have to give haploid sizes of each pool. Here, I had mostly 40 individuals per pool, and since I am working with diploid species, we multiply that by 2,  to get 80 individuals for most pools.
psizes &amp;lt;- as.numeric(c(&amp;#39;80&amp;#39;, &amp;#39;80&amp;#39;, &amp;#39;80&amp;#39;, &amp;#39;80&amp;#39;, &amp;#39;80&amp;#39;, &amp;#39;80&amp;#39;, &amp;#39;80&amp;#39;, &amp;#39;80&amp;#39;, &amp;#39;78&amp;#39;, &amp;#39;80&amp;#39;, &amp;#39;80&amp;#39;, &amp;#39;80&amp;#39;, &amp;#39;80&amp;#39;, &amp;#39;60&amp;#39;))

# Then we give the names of each pool/sample.
pnames &amp;lt;- as.character(c(&amp;#39;PN&amp;#39;, &amp;#39;HB&amp;#39;, &amp;#39;BB&amp;#39;, &amp;#39;LB&amp;#39;, &amp;#39;JB&amp;#39;, &amp;#39;SP&amp;#39;, &amp;#39;BT&amp;#39;, &amp;#39;CA&amp;#39;, &amp;#39;MB&amp;#39;, &amp;#39;KY&amp;#39;, &amp;#39;CF&amp;#39;, &amp;#39;PA&amp;#39;, &amp;#39;HH&amp;#39;, &amp;#39;HL&amp;#39;))

# Here is where we read the sync file and call SNPs. The input file must have the &amp;#39;.sync&amp;#39; extension, and can also be gzipped, like in the example below. The parameters to note are: 

#1) min.rc =  the minimum # reads that an allele needs to have (across all pools) to be called 
#2) min.cov.per.pool = the minimum allowed read count per pool for SNP to be called
#3) max.cov.per.pool = the maximum read count per pool for SNP to be called 
#4) min.maf = the minimum allele frequency (over all pools) for a SNP to be called (note this is obtained from dividing the read counts for the minor allele over the total read coverage) 
#5) nlines.per.readblock = number of lines in sync file to be read simultaneously 

SG.pooldata &amp;lt;- popsync2pooldata(sync.file = &amp;quot;SG.dn.b.sync.gz&amp;quot;, poolsizes = psizes, poolnames = pnames,
                                     min.rc = 4, min.cov.per.pool = 20, max.cov.per.pool = 400,
                                     min.maf = 0.01, noindel = TRUE, nlines.per.readblock = 1e+06)

##### From this file we can compute global and per SNP FSTs
SG.snp.fsts &amp;lt;- computeFST(SG.pooldata, method = &amp;quot;Anova&amp;quot;, snp.index = NA)

##### And we can compute pairwise FSTs
SG.pair.fst &amp;lt;- computePairwiseFSTmatrix(SG.pooldata, method = &amp;quot;Anova&amp;quot;,
                                        min.cov.per.pool = 20, max.cov.per.pool = 400,
                                        min.maf = 0.01,
                                        output.snp.values = FALSE)

##### If you want to save the pairwise matrix, you can do the following:
SG.p.fst &amp;lt;- SG.pair.fst$PairwiseFSTmatrix
SG.p.fst &amp;lt;- as.data.frame(SG.p.fst)
WriteXLS(SG.p.fst, &amp;quot;SG.p.fst.xls&amp;quot;)

###### Next, we will convert the poolfstat file to BayPass input files

#### Here you get three output files = genobaypass (allele counts), poolsize (haploid size per pool), &amp;amp; snpdet (snp info matrix). These will automatically be written in your working directory. Note the subsample size here can be used to sample to a smaller number of SNPs. If the subsample size is &amp;lt;0, then all SNPs are included in the BayPass files.
pooldata2genobaypass(SG.pooldata, writing.dir = getwd(), subsamplesize = -1)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;From here, you may want to filter the SNP dataset to account for linkage disequilibrium. If so, you can use this custom script that randomly selects one SNP per every 1000 base pairs along each contig:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;################################# LD PRUNING ###############################
##################################################################################

# To run the script below, you need to take the snpdet output from the poolfstat2baypass command above, and give the columns headers. Importantly, the first column must be titled &amp;quot;scaffold&amp;quot; and the second column must be titled &amp;quot;pos&amp;quot; (these are the contig and position columns).Here I called this file &amp;#39;snpdet.pruning.txt&amp;#39;

# Read input file
data&amp;lt;-read.table(&amp;quot;snpdet.pruning.txt&amp;quot;,sep=&amp;quot;\t&amp;quot;,header=T)

# Initiate data for LD pruning
data_LD&amp;lt;-NULL

# Window for LD pruning, here at 1000 bp (select 1 SNP per 1000 base pairs)
window&amp;lt;-1000

# Print every unique contig, and for every contig, randomly subsample 1 SNP per 1000 bp window
scaffold_ID&amp;lt;-unique(data$scaffold)
for(i in 1:length(scaffold_ID)){
  print(scaffold_ID[i])
  subset&amp;lt;-data[which(data$scaffold==scaffold_ID[i]),]
for(j in 0:10){
  print(window*j+1)
  subset_bin_i&amp;lt;-subset[which(subset$pos&amp;gt;=window*j &amp;amp; subset$pos&amp;lt;=window*(j+1)),]
  random&amp;lt;-sample(1:length(subset_bin_i[,1]),1)
  subsubset&amp;lt;-subset_bin_i[random,]
  data_LD&amp;lt;-rbind(data_LD,subsubset)
}
}

# Get the unique LD pruned SNP list
uniq.LD &amp;lt;- unique(data_LD)

# Write to excel file
WriteXLS(uniq.LD, &amp;quot;SG.LD.list.xls&amp;quot;)

####### SUBSET BAYPASS FILE  ###########

# Here we are going to filter our BayPass input files to now only relate to the LD-pruned SNPs. To do this, we first need to combine the .genobaypass and .snpdet outptut files from above. So in excel or text editor, have the first columns relate to the .snpdet output, then add the .genobaypass columns following. In other words, your input file here is the contig position, allele states, and then allele counts. Make sure the columns do not have headers. Here I called this file &amp;#39;SG.snpdet.geno.txt&amp;#39;

library(dplyr)

# Read the .genobaypass/.snpdet file type explained above, relating to all SNPs
snp.data&amp;lt;-read.table(&amp;quot;SG.snpdet.geno.txt&amp;quot;,sep=&amp;quot;&amp;quot;,header=F)

# Read your LD SNP list. To make this text file, I just took the first two columns of the SG.LD.list excel file just created, and turned that into a text file. So basically a text file with first column being contig, and second column being position for all LD-pruned SNPs (but with no column headers)
ld.data&amp;lt;-read.table(&amp;quot;SG.LD.index.txt&amp;quot;,sep=&amp;quot;\t&amp;quot;,header=F)

# Filter the list of all SNPs to now only list the LD pruned SNPs
snp.data.f &amp;lt;- dplyr::inner_join(snp.data, ld.data)

# Write out as new file, and then from there you can split back up into new .snpdet and .genobaypass input files
write.table(snp.data.f, file=&amp;quot;SG.LD.snpdet.geno.txt&amp;quot;, col.names = F, row.names= F, quote = F)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now we are ready to input our LD-pruned BayPass files into &lt;a href=&#34;http://www1.montpellier.inra.fr/CBGP/software/baypass/files/BayPass_manual_2.1.pdf&#34;&gt;BayPass&lt;/a&gt;. Here we will use a combination of bash and R scripts to run through BayPass analyses. I will briefly show the main commands used in the bash scripts, and explain how they are used in combination with the R scripts.&lt;/p&gt;
&lt;p&gt;The first step is to make sure you have compiled BayPass and have it with all of your input files in your working directory (not in R directory but Terminal type of program). Then you need to understand which of the model types you want to run. The standard core model is used to asses population structure, and identify outlier SNPs using a ‘FST type approach’. Alternatively, the auxiliary covariate model can be used to identify outlier SNPs using a ‘GEA type approach’, similar to BayEnv. Here we will just use the core model. The bash script will look something like this:&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color: red;&#34;&gt;g_baypass -npop 14 -gfile SG.genobaypass -poolsizefile SG.poolsize -d0yij 8 -outprefix SG.BP -npilot 100&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Here’s some parameter explanations:&lt;/p&gt;
&lt;p&gt;-npop = number of pools&lt;/p&gt;
&lt;p&gt;-gfile &amp;amp; -poolsizefiles are relating to your input file names&lt;/p&gt;
&lt;p&gt;-d0yij = is something to do with the initial read counts and their distribution seeded into the model, and is specifically for Pool-seq data. I followed the tip in the manual that says to set it to 1/5th of the minimum pool size&lt;/p&gt;
&lt;p&gt;-outprefix = the header of the output files&lt;/p&gt;
&lt;p&gt;-npilot = number of pilot runs&lt;/p&gt;
&lt;p&gt;So after you run the above, you should then get a number of output files. What we will need for the next part in R, is the following: ’_mat_omega.out’, ’_summary_beta_params.out’, ’_summary_pi_xtx.out’. You also need to make sure you have the ‘baypass_utils.R’ R code that comes with the program, as we will be running some of these scripts now.&lt;/p&gt;
&lt;p&gt;Now we will go into R, to both visualize the results, but also to create the pseudo observation dataset (POD), which will be used to identify outlier SNPs.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;################################# BAYPASS CREATE POD ###############################
##################################################################################

source(&amp;quot;baypass_utils.R&amp;quot;)
require(corrplot) ; require(ape)
library(WriteXLS)

# Read omega matrix BayPass output
SG.omega=as.matrix(read.table(&amp;quot;SG.BP_mat_omega.out&amp;quot;))

# Identify pool names for plotting
colnames(SG.omega) &amp;lt;- c(&amp;quot;PN&amp;quot;,&amp;quot;HB&amp;quot;,&amp;quot;BB&amp;quot;,&amp;quot;LB&amp;quot;,&amp;quot;JB&amp;quot;,&amp;quot;SP&amp;quot;,&amp;quot;BT&amp;quot;,&amp;quot;CA&amp;quot;,&amp;quot;MB&amp;quot;,
            &amp;quot;KY&amp;quot;,&amp;quot;CF&amp;quot;,&amp;quot;PA&amp;quot;,&amp;quot;HH&amp;quot;, &amp;quot;HL&amp;quot;)
rownames(SG.omega) &amp;lt;- c(&amp;quot;PN&amp;quot;,&amp;quot;HB&amp;quot;,&amp;quot;BB&amp;quot;,&amp;quot;LB&amp;quot;,&amp;quot;JB&amp;quot;,&amp;quot;SP&amp;quot;,&amp;quot;BT&amp;quot;,&amp;quot;CA&amp;quot;,&amp;quot;MB&amp;quot;,
            &amp;quot;KY&amp;quot;,&amp;quot;CF&amp;quot;,&amp;quot;PA&amp;quot;,&amp;quot;HH&amp;quot;, &amp;quot;HL&amp;quot;)

# Create a correlation matrix of the omega values, which can be used to assess genomic differentiation between pools
cor.mat=cov2cor(SG.omega)
corrplot(cor.mat,method=&amp;quot;color&amp;quot;,mar=c(2,1,2,2)+0.1,
         main=expression(&amp;quot;Correlation map based on&amp;quot;~hat(Omega)))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://esnielsen.github.io/post/2020-12-06-pool-seq-analyses-poolfstat-baypass.en_files/figure-html/BayPass%20create%20POD-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# We can also assess population differentiation with hierarchical clustering:
bta14.tree=as.phylo(hclust(as.dist(1-cor.mat**2)))
plot(bta14.tree,type=&amp;quot;p&amp;quot;,
     main=expression(&amp;quot;Hier. clust. tree based on&amp;quot;~hat(Omega)~&amp;quot;(&amp;quot;*d[ij]*&amp;quot;=1-&amp;quot;*rho[ij]*&amp;quot;)&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://esnielsen.github.io/post/2020-12-06-pool-seq-analyses-poolfstat-baypass.en_files/figure-html/BayPass%20create%20POD-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Read the xtx BayPass output
SG.snp.res=read.table(&amp;quot;SG.BP_summary_pi_xtx.out&amp;quot;,h=T)

# Get the Pi Beta distribution for POD generation
SG.pi.beta.coef=read.table(&amp;quot;SG.BP_summary_beta_params.out&amp;quot;,h=T)$Mean

# Upload original data to get read counts
SG.data&amp;lt;-geno2YN(&amp;quot;SG.genobaypass&amp;quot;)

# Simulate POD dataset to use for outlier SNP detection
simu.SG &amp;lt;-simulate.baypass(omega.mat=SG.omega,nsnp=10000,sample.size=SG.data$NN,
                           beta.pi=SG.pi.beta.coef,pi.maf=0,suffix=&amp;quot;SG.BP.sim&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 1000 SNP simulated out of 10000 
## 2000 SNP simulated out of 10000 
## 3000 SNP simulated out of 10000 
## 4000 SNP simulated out of 10000 
## 5000 SNP simulated out of 10000 
## 6000 SNP simulated out of 10000 
## 7000 SNP simulated out of 10000 
## 8000 SNP simulated out of 10000 
## 9000 SNP simulated out of 10000 
## 10000 SNP simulated out of 10000&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The above R script will give you new BayPass input files with the suffix of ‘SG.BP.sim’. We will now run BayPass again with these new gfile, using a bash script such as:&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color: red;&#34;&gt;g_baypass -npop 14 -gfile G.SG.BP.sim -poolsizefile SG.poolsize -d0yij 8 -outprefix SG.BP.sim -npilot 100&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;After we have re-run BayPass with the simulated POD input files, we will come back into the R workspace.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;################################# BAYPASS GET OUTLIERS ###############################
##################################################################################

source(&amp;quot;baypass_utils.R&amp;quot;)
library(WriteXLS)

# Read the new omega matrix and compare to original. Here you want similar values between the two
SG.pod.omega=as.matrix(read.table(&amp;quot;SG.BP.sim_mat_omega.out&amp;quot;))
plot(SG.pod.omega,SG.omega) ; abline(a=0,b=1)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://esnielsen.github.io/post/2020-12-06-pool-seq-analyses-poolfstat-baypass.en_files/figure-html/BayPass%20identify%20outliers-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Get the Forstner and Moonen Distance (FMD) between simulated and original posterior estimates (here a smaller value is better) 
fmd.dist(SG.pod.omega,SG.omega)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 1.028579&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Look at POD xtx values, and identify SNPs where the xtx values are above the 99% significance threshold from the POD. So in the plot, it is those loci (dots) which are above the abline
SG.pod.xtx=read.table(&amp;quot;SG.BP.sim_summary_pi_xtx.out&amp;quot;,h=T)$M_XtX
SG.pod.thresh=quantile(SG.pod.xtx,probs=0.99)
plot(SG.snp.res$M_XtX)
abline(h=SG.pod.thresh,lty=2)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://esnielsen.github.io/post/2020-12-06-pool-seq-analyses-poolfstat-baypass.en_files/figure-html/BayPass%20identify%20outliers-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Obtain the xtx threshold. Any SNPs with an xtx value greater than this are identified as outlier SNPs
SG.pod.thresh&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##      99% 
## 18.82108&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Here I just saved the xtx values per SNP list, and then in excel/text editor filtered out the SNPs with an xtx greater than the threshold value as outliers.
SG.snp.scores &amp;lt;- as.data.frame(SG.snp.res$M_XtX)
write.table(SG.snp.scores, file=&amp;quot;SG.snp.scores.txt&amp;quot;, sep=&amp;quot;\t&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;From here you can also run the auxiliary model in BayPass to identify outliers associated with environmental variables. To do this, you do not need to run the R code above, but rather simply run another version of the bash script, and identify outliers based on their Bayes Factor values (i.e. SNPs with dB &amp;gt; 20, from the dB column of the *_summary_betai_reg.out output file).&lt;/p&gt;
&lt;p&gt;I hope this tutorial helps my fellow Pool-Seq peeps! I know there are probably more eloquent ways to run these analyses, but this should at least get the job done. As always, feel free to contact me if you have any questions :)&lt;/p&gt;
&lt;p&gt;Happy analyzing!&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>IMCC6 Talk</title>
      <link>https://esnielsen.github.io/project/imcc6.talk/</link>
      <pubDate>Sat, 22 Aug 2020 16:32:54 +0200</pubDate>
      
      <guid>https://esnielsen.github.io/project/imcc6.talk/</guid>
      <description>&lt;p&gt;Below is my oral presentation at the 2020 &lt;a href=&#34;https://conbio.org/mini-sites/imcc6/&#34; target=&#34;_blank&#34;&gt;International Marine Conservation Congress&lt;/a&gt;, in which I condense my PhD into a ten minute talk (which is a great science communication exercise!).&lt;/p&gt;

&lt;p&gt;This was my first online conference, which I really enjoyed because if you missed anything you could watch it later, asking questions wasn&amp;rsquo;t as intimidating as in person, and talks were spread out over two weeks which made the whole experience less draining than an in person conference! As I mention in my talk, online is definitely the future of conservation conferences!&lt;/p&gt;

&lt;p&gt;But of course with Murphy&amp;rsquo;s law, we had unexpected power cuts right before my talk, and so thankfully everything was charged and it was daytime (but my stress levels still went way up)! This experience showed me that even though online conferences make it much easier for those in the Global South and developing countries to attend, there are still biases that occur, such as access to electricity and internet, which still need to be addressed for fully equitable conferences in the future.&lt;/p&gt;

&lt;p&gt;Here&amp;rsquo;s to making science and research more accessible to all. Hope you enjoy!&lt;/p&gt;


&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/INoQIwWZcdk&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

</description>
    </item>
    
    <item>
      <title>TalkClimate2Me questions</title>
      <link>https://esnielsen.github.io/project/climate.convos/</link>
      <pubDate>Wed, 22 Apr 2020 16:32:54 +0200</pubDate>
      
      <guid>https://esnielsen.github.io/project/climate.convos/</guid>
      <description>&lt;p&gt;During the COVID-19 pandemic, I have spent a lot of time trying to reflect and reconnect. Many of us are having conversations with those we haven&amp;rsquo;t spoken to in a while, and discussing topics we normally wouldn&amp;rsquo;t.&lt;/p&gt;

&lt;p&gt;As a self-proclaimed &amp;lsquo;Climate Change Person&amp;rsquo;, I am often looking to have conversations with regards to what I believe is the greatest threat our species and planet are facing (aka the climate crisis/6th mass extinction/human-induced snowballing interactions of doom). And even though we are currently in a pandemic worth talking about, I still find myself wanting to talk about COVID-19 and the chaos it has created in relation to the climate crisis.&lt;/p&gt;

&lt;p&gt;That being said, I rarely find myself actually having climate conversations. And it seems like I am not alone. Only &lt;a href=&#34;https://www.climaterealityproject.org/blog/take-number-harvey-edition-19-percent&#34; target=&#34;_blank&#34;&gt;19% of Americans&lt;/a&gt; discuss the climate crisis least once a month. After seeing this, I asked myself &amp;ldquo;WHY?&amp;rdquo;. Then, I answered myself (I talk to myself a lot), &amp;ldquo;Because it&amp;rsquo;s not like I can just bring it up easily.&amp;rdquo;&lt;/p&gt;

&lt;p&gt;We often think talking about the climate crisis has to be in a formal, direct, and emotionally heated manner. But it can start with a simple question. Below are some questions I came up to help myself jumpstart conversations, and hopefully they will reach and help some fellow climate conversationalist wanna-bes as well. Because in the words of Voltaire, &amp;lsquo;Judge a man by his questions rather than his answers&amp;rsquo;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Questions to lead into climate change discussion:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;What is your favorite plant/animal? Why? Have you seen it in the wild?&lt;/p&gt;

&lt;p&gt;What is your favorite memory in nature?&lt;/p&gt;

&lt;p&gt;Would you rather explore the deep ocean or the densest forests?&lt;/p&gt;

&lt;p&gt;Do you think we should spend money on restoring Earth or colonizing new planets?&lt;/p&gt;

&lt;p&gt;What is your favorite disaster movie? Do you think natural disasters are getting worse?&lt;/p&gt;

&lt;p&gt;What do you think the benefits/dangers of current technology are? Do you think technology is helping or hurting our relationship with nature?&lt;/p&gt;

&lt;p&gt;If you could make any change to the Earth, what would it be?&lt;/p&gt;

&lt;p&gt;What do you think is the biggest problem we will face in the future? What do you think is the biggest problem we have faced in the past?&lt;/p&gt;

&lt;p&gt;How far do you think the influences of your actions go?&lt;/p&gt;

&lt;p&gt;Have you ever experienced fake news? What was it? How did you find out?&lt;/p&gt;

&lt;p&gt;What are your hopes for your children?&lt;/p&gt;

&lt;p&gt;What do you value most about nature?&lt;/p&gt;

&lt;p&gt;What would you say your privileges are? How can you use them to help those that are under-privileged?&lt;/p&gt;

&lt;p&gt;When was the last time you were influenced by something/someone?&lt;/p&gt;

&lt;p&gt;Where do you get your information about the world?&lt;/p&gt;

&lt;p&gt;What do you want your legacy to be?&lt;/p&gt;

&lt;p&gt;What is your relationship with food?&lt;/p&gt;

&lt;p&gt;What kind of traditions do you practice, and what role do they play in your life? Do you think traditions should adapt with new generations?&lt;/p&gt;

&lt;p&gt;What freedoms are you thankful for?&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Questions once on the topic of climate change:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Do you think humans have a moral responsibility to protect other living things?&lt;/p&gt;

&lt;p&gt;How do you think we ended up in this climate crisis? What actions do you think led us here and why?&lt;/p&gt;

&lt;p&gt;What is your relationship with nature/the climate? How do you think that relationship will look like in the future?&lt;/p&gt;

&lt;p&gt;What are the things you think humanity is doing right?&lt;/p&gt;

&lt;p&gt;Do you think we as humans are part of ecosystems? Or are we in control of them?&lt;/p&gt;

&lt;p&gt;What is something you want to learn more about with regards to nature/climate?&lt;/p&gt;

&lt;p&gt;What emotions come up when you think about our history/future on Earth?&lt;/p&gt;

&lt;p&gt;What are some changes you want to make but are struggling to? What do you think are the biggest roadblocks to creating change?&lt;/p&gt;

&lt;p&gt;Do you worry about climate change? Why/why not? Why do you think some people may think the opposite?&lt;/p&gt;

&lt;p&gt;Do you feel guilty about doing anything which is bad for the environment? Have others made you feel guilty? Do you think you have made others feel guilty?&lt;/p&gt;

&lt;p&gt;What actions should we take for a better future / to re-create how things were in the past?&lt;/p&gt;

&lt;p&gt;What systems need to change the most to tackle the climate crisis?&lt;/p&gt;

&lt;p&gt;What do you think your individual role is in taking action against the climate crisis? What sacrifices would you need to make to fulfill this role?&lt;/p&gt;

&lt;p&gt;What are some changes you&amp;rsquo;ve seen in your hometown with regards to the climate? Has it affected your life? Do you think it will in the future?&lt;/p&gt;

&lt;p&gt;What jobs do you think are the most important now/will be the most important in the future?&lt;/p&gt;

&lt;p&gt;What are actions you want to take to be more environmentally friendly?  Where did you learn about these? What are some you&amp;rsquo;ve made in the past? What moved you to make them?&lt;/p&gt;

&lt;p&gt;??????&lt;/p&gt;

&lt;p&gt;And that&amp;rsquo;s all I came up with for now! Feel free to add your own and share with the hashtag: #TalkClimate2Me&lt;/p&gt;

&lt;p&gt;Happy discussing :)&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Coastal SDMs</title>
      <link>https://esnielsen.github.io/post/coastal-species-distribution-models/</link>
      <pubDate>Wed, 25 Mar 2020 00:00:00 +0000</pubDate>
      
      <guid>https://esnielsen.github.io/post/coastal-species-distribution-models/</guid>
      <description>&lt;div id=&#34;coastal-species-distribution-models&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Coastal Species Distribution Models&lt;/h2&gt;
&lt;p&gt;This tutorial will discuss how to run Species Distribution Models (SDMs) on coastal species using biomod2 in R. In this example we will use models to estimate the probability of occurence at two timepoints: present day and the Last Glacial Maximum (LGM). You can do the same with more time points, into the past and/or future.&lt;/p&gt;
&lt;p&gt;We will obtain the predictor environmental variables from &lt;a href=&#34;http://www.bio-oracle.org/&#34;&gt;Bio-Oracle&lt;/a&gt; with the R package sdmpredictors. Since I work on intertidal species, I want to include both terrestrial and marine environmental variables. We will first load and stack the layers.&lt;/p&gt;
&lt;p&gt;It is also important to only include variables that are available at both time points you want to model.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(sdmpredictors)

# Download present day environmental variables
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


#download terrestrial features (Temp_max, Temp_min, Temp_range)
terr &amp;lt;- load_layers( layercodes = c(&amp;quot;WC_bio5&amp;quot;, &amp;quot;WC_bio6&amp;quot;, &amp;quot;WC_bio7&amp;quot;) , equalarea=FALSE, rasterstack=TRUE)

#download marine features
mar &amp;lt;- load_layers( layercodes = c(&amp;quot;MS_biogeo08_sss_mean_5m&amp;quot;, &amp;quot;MS_biogeo13_sst_mean_5m&amp;quot;) , equalarea=FALSE, rasterstack=TRUE)

#check the chacteristics of each raster stack
terr&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## class      : RasterStack 
## dimensions : 1800, 4320, 7776000, 3  (nrow, ncol, ncell, nlayers)
## resolution : 0.08333333, 0.08333333  (x, y)
## extent     : -180, 180, -60, 90  (xmin, xmax, ymin, ymax)
## crs        : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 
## names      : WC_bio5, WC_bio6, WC_bio7 
## min values :    -7.3,   -55.5,     5.3 
## max values :    48.9,    25.8,    72.5&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;mar&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## class      : RasterStack 
## dimensions : 2160, 4320, 9331200, 2  (nrow, ncol, ncell, nlayers)
## resolution : 0.08333333, 0.08333333  (x, y)
## extent     : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
## crs        : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 
## names      : MS_biogeo08_sss_mean_5m, MS_biogeo13_sst_mean_5m 
## min values :                   -0.05,                   -2.00 
## max values :                   40.43,                   30.40&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Notice how the two raster stacks have different dimensions. In order to stack our terrestrial and marine rasters, we will need to resample them to have the same dimensions.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;#Resample the marine by the terrestrial layers and stack into one raster stack

t&amp;lt;-extent(-180, 180, -90, 90) #layer extent from terrestrial stack
m&amp;lt;-extent(-180, 180, -90, 90) #layer extent from marine stack
#no need to edit the following 6 lines
extent_list&amp;lt;-list(t, m)
extent_list&amp;lt;-lapply(extent_list, as.matrix)
matrix_extent&amp;lt;-matrix(unlist(extent_list), ncol=length(extent_list))
rownames(matrix_extent)&amp;lt;-c(&amp;quot;xmin&amp;quot;, &amp;quot;ymin&amp;quot;, &amp;quot;xmax&amp;quot;, &amp;quot;ymax&amp;quot;)
best_extent&amp;lt;-extent(min(matrix_extent[1,]), max(matrix_extent[3,]), min(matrix_extent[2,]), max(matrix_extent[4,]))
ranges&amp;lt;-apply(as.matrix(best_extent), 1, diff)

reso&amp;lt;-res(terr) #choose layer you want to keep resolution
nrow_ncol&amp;lt;-ranges/reso
s2&amp;lt;-raster(best_extent, nrows=nrow_ncol[2], ncols=nrow_ncol[1], crs=terr@crs) #choose layer crs you want to keep

t.2 &amp;lt;-resample(terr, s2, method=&amp;quot;ngb&amp;quot;) #resample terr by s2
m.2 &amp;lt;-resample(mar, s2, method=&amp;quot;ngb&amp;quot;) #resample mar by s2
env=stack(t.2, m.2) #stack resampled layers

# Set study extent
SA.ext &amp;lt;- extent(10, 40, -37, -22)

# Crop raster layer by extent &amp;amp; plot
env.c &amp;lt;- crop(env, SA.ext)
plot(env.c)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://esnielsen.github.io/post/coastal.sdm_files/figure-html/resample%20and%20crop-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Plotting the environmental layers should give you a figure such as the above. Now we have a single raster stack called ‘env’. We now need to remove highly correlated environmental variables.&lt;/p&gt;
&lt;p&gt;Here we will need to include our species presence data, which should include three columns: columns 1 &amp;amp; 2: x and y coordinates; column 3: presence (1) or absence (0) at each coordinate.&lt;/p&gt;
&lt;p&gt;To check for variable collinearity, we will first extract the environmental data for each coordinate, create a correlation circle, and then calculate the variance inflation factor, or VIF.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Filter environmental variables to account for collinearity
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

# Import your presence data and plot
pres.data &amp;lt;-read.table(&amp;quot;Cpunctatus.pres2.txt&amp;quot;,sep=&amp;quot;\t&amp;quot;,header=T)
plot(env.c$WC_bio5)
points(pres.data[,1:2], pch=19, col=&amp;quot;black&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://esnielsen.github.io/post/coastal.sdm_files/figure-html/vifs-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Extract env values for our species locations:
envdata &amp;lt;- extract(x=env.c, y=cbind(pres.data$x, pres.data$y))

# Run PCA and plot correlation circle
# The `dudi.pca` function allows us to perform the PCA over the whole study area. We decide to keep only 2 principal component axes to summarize the whole environmental niche. NB: here be careful that none of your xy presence points are outside of the environmental raster layer, which will give NA values, which will give errors. 

library(ade4)

pca1 &amp;lt;- dudi.pca(envdata, scannf = F, nf = 2)
round(pca1$eig/sum(pca1$eig)*100, 2)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 54.97 28.58 12.85  3.60&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Plot the PCA to look for potential outliers in the environmental data.
plot(pca1$li[,1:2]) # PCA scores on first two axes&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://esnielsen.github.io/post/coastal.sdm_files/figure-html/vifs-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;summary(pca1$li)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##      Axis1              Axis2        
##  Min.   :-5.08541   Min.   :-1.6900  
##  1st Qu.:-0.69014   1st Qu.:-0.9985  
##  Median :-0.02031   Median :-0.3923  
##  Mean   : 0.00000   Mean   : 0.0000  
##  3rd Qu.: 1.30403   3rd Qu.: 1.0404  
##  Max.   : 2.52228   Max.   : 2.5989&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Plot a correlation circle. 
s.corcircle(pca1$co)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://esnielsen.github.io/post/coastal.sdm_files/figure-html/vifs-3.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# From the correlation circle, we want to select variables on different axes and not in the same/overlapping environmental space. If there are multiple variables in the same quadrant of the circle, we should choose the one with a longer arrow, as that means it varies more over the environmental space, which is preferred. However, it is also important to know which environmental features are more relevant to your study species, and to choose according to the ecology of each species. 

# A note on arrow directions: same direction = highly correlated, orthogonal (this means at a 90 degree angle) = unrelated, opposite directions = negatively correlated


# From the plot, we can get rid of variable WC_bio6, and plot again. 

VARSEL &amp;lt;- c(&amp;quot;WC_bio5&amp;quot;, &amp;quot;WC_bio7&amp;quot;, &amp;quot;MS_biogeo08_sss_mean_5m&amp;quot;, &amp;quot;MS_biogeo13_sst_mean_5m&amp;quot;) #select variables we want to keep
env.c.2 &amp;lt;- stack(subset(env.c, VARSEL)) #subset the rasterstack by the retained variables
envdata &amp;lt;- extract(x=env.c.2, y=cbind(pres.data$x, pres.data$y)) 
pca1 &amp;lt;- dudi.pca(envdata, scannf = F, nf = 2)
s.corcircle(pca1$co)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://esnielsen.github.io/post/coastal.sdm_files/figure-html/vifs-4.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Additionally assess the correlation with VIF
## Calculate variance inflation factor (VIF). Generally you want to exclude variables with a VIF&amp;gt;10. 
library(usdm)

vif(env.c.2)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##                 Variables       VIF
## 1                 WC_bio5 13.712553
## 2                 WC_bio7  5.311111
## 3 MS_biogeo08_sss_mean_5m  2.367307
## 4 MS_biogeo13_sst_mean_5m  9.803145&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;#Since WC_bio5 has VIF &amp;gt; 10, then we will remove to create a final environmental raster stack for our models.

VARSEL2 &amp;lt;- c(&amp;quot;WC_bio7&amp;quot;, &amp;quot;MS_biogeo08_sss_mean_5m&amp;quot;, &amp;quot;MS_biogeo13_sst_mean_5m&amp;quot;) #select variables we want to keep
env.c.3 &amp;lt;- stack(subset(env.c.2, VARSEL2))

# We can write the raster stack to save in the home directory. 
writeRaster(env.c.3, filename=&amp;quot;env.current.tif&amp;quot;, format=&amp;quot;GTiff&amp;quot;, overwrite=TRUE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now that we have our final set of variables, we can download the same variables for the Last Glacial Maximum (LGM), 21,000 years ago. The environmental features from Bio-Oracle automatically include the lowered sea levels at the LGM which is nice.&lt;/p&gt;
&lt;p&gt;It is generally good practice to include multiple climatic models. Here we will include two models: CCSM4 and MIROC. The oceanic layers are already an ensemble of multiple models, so we will use the ensemble without CCSM with the MIROC terrestrial layer, and the ocean model including CCSM with the CCSM terrestrial layer.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Download historical environmental data
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


# Load layers and make sure they are in the same order as your contemporary raster stack (WC_bio5, WC_bio7, SSS, SST)

a.miroc.21 &amp;lt;- load_layers(layercodes = c(&amp;quot;WC_bio7_cclgm&amp;quot;), equalarea=FALSE, rasterstack=TRUE, 
                         datadir=NULL)

a.ccsm.21 &amp;lt;- load_layers(layercodes = c(&amp;quot;WC_bio7_mrlgm&amp;quot;), equalarea=FALSE, rasterstack=TRUE, 
                        datadir=NULL)

o.ens.adj.21 &amp;lt;- load_layers(layercodes = c(&amp;quot;MS_biogeo08_sss_mean_21kya_adjCCSM&amp;quot;, &amp;quot;MS_biogeo13_sst_mean_21kya_adjCCSM&amp;quot;), equalarea=FALSE, rasterstack=TRUE, 
                       datadir=NULL)

o.ens.nc.21 &amp;lt;- load_layers(layercodes = c(&amp;quot;MS_biogeo08_sss_mean_21kya_noCCSM&amp;quot;, &amp;quot;MS_biogeo13_sst_mean_21kya_noCCSM&amp;quot;), equalarea=FALSE, rasterstack=TRUE, 
                            datadir=NULL)

a.miroc.21.2 &amp;lt;-resample(a.miroc.21, s2, method=&amp;quot;ngb&amp;quot;)
a.ccsm.21.2 &amp;lt;-resample(a.ccsm.21, s2, method=&amp;quot;ngb&amp;quot;) 
o.ens.adj.21.2 &amp;lt;-resample(o.ens.adj.21, s2, method=&amp;quot;ngb&amp;quot;)
o.ens.nc.21.2 &amp;lt;-resample(o.ens.nc.21, s2, method=&amp;quot;ngb&amp;quot;)

miroc.21 =stack(a.miroc.21.2, o.ens.nc.21.2 ) 
ccsm.21 =stack(a.ccsm.21.2, o.ens.adj.21.2 )

miroc.21.crop &amp;lt;- crop(miroc.21, SA.ext)
ccsm.21.crop &amp;lt;- crop(ccsm.21, SA.ext)

miroc.21.c &amp;lt;- stack(miroc.21.crop)
ccsm.21.c &amp;lt;- stack(ccsm.21.crop)

writeRaster(miroc.21.c, filename=&amp;quot;miroc.21.tif&amp;quot;, format=&amp;quot;GTiff&amp;quot;, overwrite=TRUE)
writeRaster(ccsm.21.c, filename=&amp;quot;ccsm.21.tif&amp;quot;, format=&amp;quot;GTiff&amp;quot;, overwrite=TRUE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We are now ready to run our SDMs, using the package biomod2. We can use our environmental raster stack (for the present day) and presence data to create pseudo-absence data.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(biomod2)

# Create presence and absence data
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

# Convert the column named &amp;quot;PRESENCE&amp;quot; to a character class
myResp&amp;lt;-as.numeric(pres.data$Cpunctatus)

myRespName &amp;lt;- &amp;#39;Cpunctatus&amp;#39;

# Create presence and pseudo absences
SPC_PresAbs &amp;lt;- BIOMOD_FormatingData(resp.var = myResp,
                                    expl.var = env.c.3,
                                    resp.xy = pres.data[,c(&amp;#39;x&amp;#39;, &amp;#39;y&amp;#39;)],
                                    resp.name = myRespName,
                                    PA.nb.rep = 3,
                                    PA.nb.absences = 10000,
                                    PA.strategy = &amp;#39;random&amp;#39;) &lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## -=-=-=-=-=-=-=-=-=-=-=-=-= Cpunctatus Data Formating -=-=-=-=-=-=-=-=-=-=-=-=-=
## 
##       ! No data has been set aside for modeling evaluation
##    &amp;gt; Pseudo Absences Selection checkings...
##    &amp;gt; random pseudo absences selection
##    &amp;gt; Pseudo absences are selected in explanatory variables
##          ! Some NAs have been automaticly removed from your data
## -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= Done -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;##  NOTE: if you get an error that looks like this:
## &amp;#39;Error in .BIOMOD_FormatingData.check.args(resp.var, expl.var, resp.xy,  : Explanatory variable must be one of numeric, data.frame, matrix, RasterLayer, RasterStack, SpatialPointsDataFrame, SpatialPoints&amp;#39;

#Then simply re-create your raster stack and try again. As such:
env.c.2 &amp;lt;- stack(env.c.2)


SPC_PresAbs &amp;lt;- BIOMOD_FormatingData(resp.var = myResp,
                                    expl.var = env.c.3,
                                    resp.xy = pres.data[,c(&amp;#39;x&amp;#39;, &amp;#39;y&amp;#39;)],
                                    resp.name = myRespName,
                                    PA.nb.rep = 3,
                                    PA.nb.absences = 10000,
                                    PA.strategy = &amp;#39;random&amp;#39;) &lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## -=-=-=-=-=-=-=-=-=-=-=-=-= Cpunctatus Data Formating -=-=-=-=-=-=-=-=-=-=-=-=-=
## 
##       ! No data has been set aside for modeling evaluation
##    &amp;gt; Pseudo Absences Selection checkings...
##    &amp;gt; random pseudo absences selection
##    &amp;gt; Pseudo absences are selected in explanatory variables
##          ! Some NAs have been automaticly removed from your data
## -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= Done -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Check the number of absences
SPC_PresAbs&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## -=-=-=-=-=-=-=-=-=-=-=-=-= &amp;#39;BIOMOD.formated.data.PA&amp;#39; -=-=-=-=-=-=-=-=-=-=-=-=-=
## 
## sp.name =  Cpunctatus
## 
##   1163 presences,  0 true absences and  323 undifined points in dataset
## 
## 
##   3 explanatory variables
## 
##     WC_bio7      MS_biogeo08_sss_mean_5m MS_biogeo13_sst_mean_5m
##  Min.   :11.50   Min.   :34.78           Min.   :12.97          
##  1st Qu.:14.30   1st Qu.:35.30           1st Qu.:16.39          
##  Median :16.40   Median :35.33           Median :18.35          
##  Mean   :16.26   Mean   :35.27           Mean   :18.52          
##  3rd Qu.:17.50   3rd Qu.:35.34           3rd Qu.:21.04          
##  Max.   :22.30   Max.   :35.38           Max.   :26.01          
## 
## 
##  3 Pseudo Absences dataset available ( PA1 PA2 PA3 ) with  151 
## absences in each (true abs + pseudo abs)
## 
## -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## Notice how the output here says that there are a different number of pseudo absences than you input in the &amp;#39;PA.nb.absences&amp;#39; parameter. I am guessing this is because the same cell can be chosen as an absence over and over within this step, so I would advise playing with that parameter until you get roughly and equal amount of absences as you have presences. 

# Plot your pseudo absences
plot(SPC_PresAbs)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://esnielsen.github.io/post/coastal.sdm_files/figure-html/pseudoabs-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Next we will run model models using our presence and pseudo absence data and environmental features. Here we will run 6 different models, over 10 runs, using 30% of the data for callibration, and 70% for fitting models.&lt;/p&gt;
&lt;p&gt;We will then check how well the model performs with two separate evalution scores: ROC and TSS. Generally, a ROC &amp;gt; 0.8 and TSS &amp;gt; 0.55 are indicative of high model accuracy.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Run BIOMOD Models
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# Set modeling options (NB: refer to the package vingette for non-default model options)
MySpc_options &amp;lt;- BIOMOD_ModelingOptions(
  GLM = list( type = &amp;#39;quadratic&amp;#39;, interaction.level = 1 ),
  GBM = list( n.trees = 1000 ),
  GAM = list( algo = &amp;#39;GAM_mgcv&amp;#39; ) )

# Run the models with specific parameters.
MySpc_models &amp;lt;- BIOMOD_Modeling( data = SPC_PresAbs,
                                 models = c(&amp;quot;GLM&amp;quot;,&amp;quot;GAM&amp;quot;, &amp;quot;GBM&amp;quot;, &amp;quot;RF&amp;quot;,&amp;quot;MARS&amp;quot;, &amp;quot;FDA&amp;quot;),
                                 models.options = MySpc_options,
                                 NbRunEval = 10,
                                 DataSplit = 70,
                                 VarImport = 3,
                                 models.eval.meth=c(&amp;#39;TSS&amp;#39;,&amp;#39;ROC&amp;#39;),
                                 do.full.models = F )

# Get models evaluation scores
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
MyModels_scores &amp;lt;- get_evaluations(MySpc_models)

MyModels_scores[&amp;quot;ROC&amp;quot;,&amp;quot;Testing.data&amp;quot;,,,]
MyModels_scores[&amp;quot;TSS&amp;quot;,&amp;quot;Testing.data&amp;quot;,,,]

# Graphically see model scores
models_scores_graph(MySpc_models, by = &amp;quot;models&amp;quot; , metrics = c(&amp;quot;ROC&amp;quot;,&amp;quot;TSS&amp;quot;), xlim = c(0.5,1), ylim = c(0.5,1))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://esnielsen.github.io/post/coastal.sdm_files/figure-html/run.models-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;models_scores_graph(MySpc_models, by = &amp;quot;cv_run&amp;quot; , metrics = c(&amp;quot;ROC&amp;quot;,&amp;quot;TSS&amp;quot;), xlim = c(0.5,1), ylim = c(0.5,1))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://esnielsen.github.io/post/coastal.sdm_files/figure-html/run.models-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;models_scores_graph(MySpc_models, by = &amp;quot;data_set&amp;quot; , metrics = c(&amp;quot;ROC&amp;quot;,&amp;quot;TSS&amp;quot;), xlim = c(0.5,1), ylim = c(0.5,1))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://esnielsen.github.io/post/coastal.sdm_files/figure-html/run.models-3.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;We can also look at the importance of each environmental variable in explaining the distribution, which is calculated as the variable importance.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Variable importance in models
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

# Calculate variable importance. The higher a score is, the more important is the variable. We will visualize this as a barplot.

MyModels_var_import &amp;lt;- get_variables_importance(MySpc_models)
dimnames(MyModels_var_import)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [[1]]
## [1] &amp;quot;WC_bio7&amp;quot;                 &amp;quot;MS_biogeo08_sss_mean_5m&amp;quot;
## [3] &amp;quot;MS_biogeo13_sst_mean_5m&amp;quot;
## 
## [[2]]
## [1] &amp;quot;GLM&amp;quot;  &amp;quot;GAM&amp;quot;  &amp;quot;GBM&amp;quot;  &amp;quot;RF&amp;quot;   &amp;quot;MARS&amp;quot; &amp;quot;FDA&amp;quot; 
## 
## [[3]]
##  [1] &amp;quot;RUN1&amp;quot;  &amp;quot;RUN2&amp;quot;  &amp;quot;RUN3&amp;quot;  &amp;quot;RUN4&amp;quot;  &amp;quot;RUN5&amp;quot;  &amp;quot;RUN6&amp;quot;  &amp;quot;RUN7&amp;quot;  &amp;quot;RUN8&amp;quot;  &amp;quot;RUN9&amp;quot; 
## [10] &amp;quot;RUN10&amp;quot;
## 
## [[4]]
## Cpunctatus_PA1 Cpunctatus_PA2 Cpunctatus_PA3 
##          &amp;quot;PA1&amp;quot;          &amp;quot;PA2&amp;quot;          &amp;quot;PA3&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Average variable importance by algorithm
mVarImp &amp;lt;- apply(MyModels_var_import, c(1,2), median) 
mVarImp &amp;lt;- apply(mVarImp, 2, function(x) x*(1/sum(x))) # standardize the data
mVarImp &lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##                               GLM       GAM       GBM        RF      MARS
## WC_bio7                 0.2578125 0.1979434 0.1516144 0.1860687 0.2718195
## MS_biogeo08_sss_mean_5m 0.3320313 0.4531766 0.7033224 0.4394084 0.4386095
## MS_biogeo13_sst_mean_5m 0.4101563 0.3488799 0.1450632 0.3745229 0.2895710
##                               FDA
## WC_bio7                 0.1478463
## MS_biogeo08_sss_mean_5m 0.4384944
## MS_biogeo13_sst_mean_5m 0.4136593&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;#save as table
write.table(mVarImp, file=&amp;quot;modelVarImp.txt&amp;quot;, sep=&amp;quot;\t&amp;quot;, quote = FALSE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It is also good practice to visualize the response curves pertaining to each environmental variable.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Response curves
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

# To analyze how each environmental variable influences modelled probability of species presence, we will use an evaluation procedure proposed by Elith et al.(2005). 

# A plot of these predictions allows visualisation of the modeled response(y-axis) to the given variable (x-axis),conditional to the other variables being held constant.

# Here I will show the response curves for the RF model, but you can do this for all models:

MySpc_rf  &amp;lt;- BIOMOD_LoadModels(MySpc_models, models=&amp;#39;RF&amp;#39;)

rf_eval_strip &amp;lt;- biomod2::response.plot2(
  models  = MySpc_rf, Data = get_formal_data(MySpc_models,&amp;#39;expl.var&amp;#39;), 
  show.variables= get_formal_data(MySpc_models,&amp;#39;expl.var.names&amp;#39;),
  do.bivariate = FALSE, fixed.var.metric = &amp;#39;median&amp;#39;, legend = FALSE,
  display_title = FALSE, data_species = get_formal_data(MySpc_models,&amp;#39;resp.var&amp;#39;))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://esnielsen.github.io/post/coastal.sdm_files/figure-html/response.curves-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Now we will project our models onto the current climate, and see how well they predict the current distribution. Running this script will create a folder in your directory called ‘current’. Note that this will automatically overwrite any other folder of the same name.&lt;/p&gt;
&lt;p&gt;Afterwards we will create the ensemble model, which will combine the 6 model types we specified earlier. Here we will use a TSS cut off of 0.55 and ROC cut off of 0.8.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Map individual models onto the current Southern African climate
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

MySpc_models_proj_current &amp;lt;- BIOMOD_Projection( modeling.output = MySpc_models,
                                                new.env = env.c.3,
                                                proj.name = &amp;quot;current&amp;quot;,
                                                binary.meth = &amp;quot;ROC&amp;quot;,
                                                output.format = &amp;quot;.img&amp;quot;,
                                                do.stack = FALSE )


# Plot and compare the maps for the potential current distribution projected by the different models.
plot(MySpc_models_proj_current,  str.grep=&amp;quot;PA1_RUN1&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://esnielsen.github.io/post/coastal.sdm_files/figure-html/ensemble.models-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# If any of the models over or under estimate the distribution, then you can consider leaving them out of the ensemble model. 


# Run ensemble models
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

MySpc_ensemble_models &amp;lt;- BIOMOD_EnsembleModeling( modeling.output = MySpc_models,
                                                  chosen.models =&amp;#39;all&amp;#39;,
                                                  em.by = &amp;#39;all&amp;#39;,  #combine all models
                                                  eval.metric = &amp;#39;all&amp;#39;,
                                                  eval.metric.quality.threshold = c(0.55,0.8),
                                                  models.eval.meth = c(&amp;#39;TSS&amp;#39;,&amp;#39;ROC&amp;#39;),
                                                  prob.mean = FALSE,
                                                  prob.cv = TRUE, #coefficient of variation across predictions
                                                  committee.averaging = TRUE,
                                                  prob.mean.weight = TRUE,
                                                  VarImport = 0 )

# Check ensemble scores
MySpc_ensemble_models_scores &amp;lt;- get_evaluations(MySpc_ensemble_models)
MySpc_ensemble_models_scores


# Ensemble model forecast onto current environment
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
MySpc_ensemble_models_proj_current &amp;lt;- BIOMOD_EnsembleForecasting( 
  EM.output = MySpc_ensemble_models,
  projection.output = MySpc_models_proj_current,
  binary.meth = &amp;quot;ROC&amp;quot;,  #make binary predictions (pres/abs) based on ROC score
  output.format = &amp;quot;.img&amp;quot;,
  do.stack = FALSE )

# The projections for current conditions are stored in the &amp;#39;proj_current&amp;#39; directory. 
get_projected_models(MySpc_ensemble_models_proj_current)

# Plot them all
plot(MySpc_ensemble_models_proj_current)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://esnielsen.github.io/post/coastal.sdm_files/figure-html/ensemble.models-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(MySpc_ensemble_models_proj_current, str.grep=&amp;quot;EMcaByTSS&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://esnielsen.github.io/post/coastal.sdm_files/figure-html/ensemble.models-3.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(MySpc_ensemble_models_proj_current, str.grep=&amp;quot;EMwmeanByTSS&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://esnielsen.github.io/post/coastal.sdm_files/figure-html/ensemble.models-4.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Ensemble model hindcast onto LGM environment
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
#Fit model using new environmental variables

#First we need to re-name the raster stack layers to be the same as the &amp;#39;present-day&amp;#39; raster stack we built the model on
names(miroc.21.c) &amp;lt;- c(&amp;#39;WC_bio7&amp;#39;,&amp;#39;MS_biogeo08_sss_mean_5m&amp;#39;, &amp;#39;MS_biogeo13_sst_mean_5m&amp;#39;)

#Then project the model onto the new environmental layers
MySpc_models_proj_LGM1 &amp;lt;- BIOMOD_Projection( modeling.output = MySpc_models,
                                             new.env = miroc.21.c,
                                             proj.name = &amp;quot;miroc.LGM&amp;quot;,
                                             binary.meth = c(&amp;quot;ROC&amp;quot;),
                                             output.format = &amp;quot;.img&amp;quot;,
                                             do.stack = FALSE)



#Then run hindcasting ensemble model:
 MySpc_ensemble_models_proj_LGM1 &amp;lt;- BIOMOD_EnsembleForecasting( 
   EM.output = MySpc_ensemble_models,
   projection.output = MySpc_models_proj_LGM1,
   binary.meth = &amp;quot;ROC&amp;quot;,
   output.format = &amp;quot;.img&amp;quot;,
   do.stack = FALSE,
   build.clamping.mask=F)

# Then do this same for CCSM LGM layers
names(ccsm.21.c) &amp;lt;- c(&amp;#39;WC_bio7&amp;#39;,&amp;#39;MS_biogeo08_sss_mean_5m&amp;#39;, &amp;#39;MS_biogeo13_sst_mean_5m&amp;#39;)
MySpc_models_proj_LGM2 &amp;lt;- BIOMOD_Projection( modeling.output = MySpc_models,
                                             new.env = ccsm.21.c,
                                             proj.name = &amp;quot;ccsm.LGM&amp;quot;,
                                             binary.meth = c(&amp;quot;ROC&amp;quot;),
                                             output.format = &amp;quot;.img&amp;quot;,
                                             do.stack = FALSE)

 MySpc_ensemble_models_proj_LGM2 &amp;lt;- BIOMOD_EnsembleForecasting( 
   EM.output = MySpc_ensemble_models,
   projection.output = MySpc_models_proj_LGM2,
   binary.meth = &amp;quot;ROC&amp;quot;,
   output.format = &amp;quot;.img&amp;quot;,
   do.stack = FALSE,
   build.clamping.mask=F)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Finally, we can map the outputs of the models to create a single figure in which they are compared. We will first combine the MIROC and CCSM model outputs, by averaging their values per cell. We will also enlargen the cells to make the output maps easier to read.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## Plotting SDM outputs
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

library(rasterVis)
library(gridExtra)
library(rgdal)

cc = colorRampPalette( c(&amp;quot;red&amp;quot;, &amp;quot;white&amp;quot;,&amp;quot;blue&amp;quot;))

## Retreive output maps from the different directories
MyBinCP_curr &amp;lt;- raster::stack(&amp;quot;Cpunctatus/proj_current/individual_projections/Cpunctatus_EMcaByTSS_mergedAlgo_mergedRun_mergedData.img&amp;quot;)
MyBinCP_c.LGM &amp;lt;- raster::stack(&amp;quot;Cpunctatus/proj_ccsm.LGM/individual_projections/Cpunctatus_EMcaByTSS_mergedAlgo_mergedRun_mergedData.img&amp;quot;)
MyBinCP_m.LGM &amp;lt;- raster::stack(&amp;quot;Cpunctatus/proj_miroc.LGM/individual_projections/Cpunctatus_EMcaByTSS_mergedAlgo_mergedRun_mergedData.img&amp;quot;)

# Load a shapefile to have as a background map. You can find shapefiles either on the web or from R packages such as &amp;#39;rnaturalearth&amp;#39;
SAmap &amp;lt;- readOGR(&amp;quot;Cpunctatus/Africa.shp&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## OGR data source with driver: ESRI Shapefile 
## Source: &amp;quot;/Users/ericaspotswoodnielsen/Desktop/website/SDM.tutorial/Cpunctatus/Africa.shp&amp;quot;, layer: &amp;quot;Africa&amp;quot;
## with 762 features
## It has 3 fields&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;SAmap.c &amp;lt;- crop(SAmap, SA.ext)

# Make ensemble output maps by combining the miroc and ccsm models (by averaging cell values)
CP.mean.LGM &amp;lt;- merge(MyBinCP_c.LGM, MyBinCP_m.LGM)

# Aggregate the cells to make the output more visable (this doubles the size of the cells)
CP.mean.LGM.agg &amp;lt;- aggregate(CP.mean.LGM, fact=2)
MyBinCP_c.agg &amp;lt;- aggregate(MyBinCP_curr, fact=2)

# Stack the current and LGM output layers
CP.sdms &amp;lt;- stack(MyBinCP_c.agg, CP.mean.LGM.agg)
names(CP.sdms) &amp;lt;- c(&amp;#39;Current&amp;#39;, &amp;#39;LGM&amp;#39;)

#Plot the current and LGM rasters in single plot
levelplot(CP.sdms, col.regions=cc, layout=c(1, 2)) + layer(sp.polygons(SAmap.c, fill=&amp;#39;white&amp;#39;, alpha=0.2))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://esnielsen.github.io/post/coastal.sdm_files/figure-html/plot.outputs-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;And here we have the final product, showing the average habitat suitability at two timepoints.&lt;/p&gt;
&lt;p&gt;Thanks for reading, and feel free to let me know if you have any questions!&lt;/p&gt;
&lt;p&gt;Post written by Erica Nielsen, R scripts written by Nikki Phair and Erica Nielsen.&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>My Dance Your PhD Entry!</title>
      <link>https://esnielsen.github.io/project/dance-your-phd-entry/</link>
      <pubDate>Fri, 21 Feb 2020 16:32:54 +0200</pubDate>
      
      <guid>https://esnielsen.github.io/project/dance-your-phd-entry/</guid>
      <description>&lt;p&gt;Below is my entry for the 2020 &amp;lsquo;Dance Your PhD&amp;rsquo; video contest created by &lt;a href=&#34;http://gonzolabs.org/dance/&#34; target=&#34;_blank&#34;&gt;Gonzo Labs&lt;/a&gt; and &lt;a href=&#34;https://www.sciencemag.org/projects/dance-your-phd&#34; target=&#34;_blank&#34;&gt;Science Magazine&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;With this video I aimed to describe a chapter of my PhD via dance, but also hoped to achieve the following:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;make concepts of population genetics accessible to those with little previous knowledge on the subject&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;engage and collaborate with local dance groups to conduct knowledge transfer between the sciences and the arts&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;create a unique video that combines my love of dance and science, and have fun while doing it!&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This project is dedicated to my family, whom I hope understands what my PhD is about after watching this video :)&lt;/p&gt;

&lt;p&gt;Enjoy!&lt;/p&gt;


&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/Ur-M1u5TeVc&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

</description>
    </item>
    
    <item>
      <title>A comparison of genetic and genomic approaches to represent evolutionary potential in conservation planning </title>
      <link>https://esnielsen.github.io/publication/bio.cons.2020/</link>
      <pubDate>Wed, 01 Jan 2020 00:00:00 -0800</pubDate>
      
      <guid>https://esnielsen.github.io/publication/bio.cons.2020/</guid>
      <description></description>
    </item>
    
    <item>
      <title>Multi-model seascape genomics identifies distinct environmental drivers of selection among sympatric marine species</title>
      <link>https://esnielsen.github.io/publication/bmc.eb.2020/</link>
      <pubDate>Wed, 01 Jan 2020 00:00:00 -0800</pubDate>
      
      <guid>https://esnielsen.github.io/publication/bmc.eb.2020/</guid>
      <description></description>
    </item>
    
    <item>
      <title>2019 Conservation Symposium Review</title>
      <link>https://esnielsen.github.io/project/sccp_2019/</link>
      <pubDate>Sat, 14 Dec 2019 16:32:54 +0200</pubDate>
      
      <guid>https://esnielsen.github.io/project/sccp_2019/</guid>
      <description>&lt;p&gt;On Nov 4-7th 2019 I had the opportunity to attend The Conservation Symposium, which aims to bring together those working on conservation issues within South Africa.&lt;/p&gt;

&lt;p&gt;I enjoy this conference because it takes me out of my academia bubble and transports me into the ‘on the ground’ conservation practice realm. Students and academics make up a small portion of the attendees, outnumbered by NGOs, consulting companies, government organizations, attorneys, reporters, and filmmakers.&lt;/p&gt;

&lt;p&gt;The main theme that struck me throughout this conference is the need to understand the human dimension to ensure effective conservation planning and management. Below I discuss a few of the key insights I had in relation to this topic.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;This year they had the first ever session dedicated to indigenous knowledge (IK) in conservation. It was interesting to see how as a country we are actually quite ahead of the game in the inclusion of IK in conservation publications. But the thing that irked me during this session was that the audience laughed at almost all mentions of local taboos (an example of which is that some indigenous people believe that touching a certain tree species causes women to immediately start menstruating). I think this demonstrates how far we have yet to go in reframing our mindsets to see conservation not from a typical westernized view, but from a more inclusive, open-minded framing.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;I also noted how all of the IK-related talks were in a terrestrial setting. I searched ‘South Africa indigenous knowledge marine’ in Web of Science and found zero papers investigating the use of IK in marine conservation. But, this made me remember an interesting poster at this year’s WIOMSA symposium where they interviewed local fishers along the South African coastline asking if water temperatures were changing, and reported areas where fishers’ knowledge differed from temperature changes monitored by scientists. We still have a long way to go with integrating IK into conservation management, and I think we will see a lot more marine conservation studies incorporating aspects of local communities in the near future.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;This year the symposium also introduced the Conservation Café, which involved youth-led discussions on conservation topics chosen by young (&amp;lt;35 yrs) attendants. During the tea breaks, we wrote on a white board what we wanted to discuss or added stars next to those topics on the board that we were interested in (seen in pictures below). In the session I went to, we talked again about IK within conservation, but also about capitalism and the goal of conservation. It was a lot of discussing problems, but one of the solutions I took away was that as youth we need to use our voices on social media, and also broaden our social circles in real life (or IRL as the kids say these days) to actively ‘market’ sustainable lifestyles and ‘make conservation cool again’.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Lastly, there were some very interesting talks on how people perceive our parks within the country. Nyiko Mutileni gave a talk on her work where she interviewed local communities just a few km outside of Man’ombe Nature Reserve, asking if they have every entered the reserve, and if they benefit from the reserve. Many local people had never even heard of the park, only ~3% had entered the park, and most believed they did not benefit from the park because they could no longer access natural resources. Another talk by Dr Izak Smit described how he interviewed visitors of Kruger National Park to understand how they perceived conservation. Most visitors do not believe that conservation areas should be focused on making money, or that we humans should actively manage nature through ‘harsh’ management such as culling. But most surprising to me was almost half of the interviewees believe that humans are separate from nature rather than interconnected through ecological processes. Dr Smit mentioned how this is partly driven by the fact that while 1.9 million people visit Kruger annually, only ~1% actually get out of their cars, walk in the bush, and physically connect with nature. Our disconnect with the natural world is a major issue of our time (shown by the fact that I had to mention ‘in real life’ in the previous point), and protected areas will be fundamental to our individual and societal resilience as we face ever increasing uncertainties on this Earth.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&#34;https://esnielsen.github.io/img/sccp/p1.jpg&#34; alt=&#34;Example image&#34; /&gt;
&lt;img src=&#34;https://esnielsen.github.io/img/sccp/p2.jpg&#34; alt=&#34;Example image&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Youth 4 Conservation</title>
      <link>https://esnielsen.github.io/project/youth4cons/</link>
      <pubDate>Sun, 22 Sep 2019 16:32:54 +0200</pubDate>
      
      <guid>https://esnielsen.github.io/project/youth4cons/</guid>
      <description>&lt;p&gt;Below is my entry to the Youth4Conservation video contest for the 2019 South African &lt;a href=&#34;https://conservationsym2019.dryfta.com/&#34; target=&#34;_blank&#34;&gt;Conservation Symposium&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The &lt;a href=&#34;https://youth4conservation.co.za/&#34; target=&#34;_blank&#34;&gt;Youth4Conservation&lt;/a&gt; movement partners young volunteers with local conservation organisations to help tackle critical conservation issues within South Africa.&lt;/p&gt;

&lt;p&gt;This year, the Conservation Symposium partnered with &lt;a href=&#34;http://wildtrust.co.za/&#34; target=&#34;_blank&#34;&gt;WildTrust&lt;/a&gt;, offering discounted registration prices to young attendees who send a short video describing how they are contributing to conservation within South Africa.&lt;/p&gt;

&lt;p&gt;With this video, I hope to share why genetics and genomics are important to conserving biodiversity, especially with regards to an uncertain climatic future.&lt;/p&gt;

&lt;p&gt;Enjoy!&lt;/p&gt;


&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//player.vimeo.com/video/358497236&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; webkitallowfullscreen mozallowfullscreen allowfullscreen&gt;&lt;/iframe&gt;
 &lt;/div&gt;

</description>
    </item>
    
    <item>
      <title>2019 WIOMSA Symposium Review</title>
      <link>https://esnielsen.github.io/project/wiomsa/</link>
      <pubDate>Fri, 14 Dec 2018 16:32:54 +0200</pubDate>
      
      <guid>https://esnielsen.github.io/project/wiomsa/</guid>
      <description>&lt;p&gt;During July 1-5 2019, I attended the 11th Western Indian Ocean Marine Science Association (WIOMSA) symposium at the University of Mauritius with two of my colleagues Nikki and Molly.&lt;/p&gt;

&lt;p&gt;WIOMSA is always a great conference as it covers a variety of scientific disciplines and has a strong focus on integrating research and management within the region. Some of the highlights were:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Prof Golden’s &lt;a href=&#34;https://escholarship.org/content/qt0g805047/qt0g805047.pdf&#34; target=&#34;_blank&#34;&gt;plenary&lt;/a&gt; which discussed the impacts of climate change on small-scale fisheries and human nutrition. Here we were shown which countries were most vulnerable to malnutrition due to declined marine catches, and also which fish species are ideal candidates for aquaculture within these countries based on their sustainability and nutritional value.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Prof Dupont’s &lt;a href=&#34;https://www.nature.com/articles/498429a&#34; target=&#34;_blank&#34;&gt;plenary&lt;/a&gt; which discussed the vast and complex implications of ocean acidification. Prof Dupont proved how science communication can make something intangible, such as ocean acidification, tangible, by offering shrimp tastings where people could actually taste the difference between seafood raised in normal or low pH conditions.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;The science communication mini-symposium, as well as the multiple videos that were shown during the conference (including the following: &lt;a href=&#34;https://www.youtube.com/watch?v=LI7Xx21ESoY&#34; target=&#34;_blank&#34;&gt;mzansi&lt;/a&gt; &amp;amp; &lt;a href=&#34;https://vimeo.com/344745676&#34; target=&#34;_blank&#34;&gt;kokoly&lt;/a&gt;)&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;The Women In Science speed dating lunch where we discussed actions we could take to improve gender equality in the context of marine conservation within the region. We highlighted the need for more information sharing via face-to-face and online, increase position papers on women in small scale fisheries, and fundraise campaigns for projects that specifically support women and communities in the region.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;The exciting discoveries and opportunities regarding the deep and open ocean. With increasing off-shore threats such as mining, we will soon need to move towards ‘high-seas’ protected areas, which should be biologically meaningful instead of simply reaching a target % of the ocean. There were multiple talks on how new technology is allowing us to assess the biodiversity of seamounts and deep-water canyons, and results suggest that these areas should be considered for MPAs outside of EEZs.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;The multiple talks on social resilience, which highlighted how social adaptive capacity is space and time specific, and needs to be conducted on different gender groups and throughout different seasons. I also thought it was interesting how social resilience was qualified, by using questionnaires that asked questions such as ‘Do you think about the future?’.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;I also enjoyed the posters and talks that showed how surfers and kitesurfers can be used to monitor oceanographic features, often by putting cameras/sensors onto boards.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Last but not least, we each took our turn identifying and mitigating threats such as dynamite fishing in a virtual reality diving game!&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Get Genetic With It</title>
      <link>https://esnielsen.github.io/project/getgenetic/</link>
      <pubDate>Fri, 14 Dec 2018 16:32:54 +0200</pubDate>
      
      <guid>https://esnielsen.github.io/project/getgenetic/</guid>
      <description>&lt;p&gt;Below is my entry to the &lt;a href=&#34;https://evolutionfilmfestival.org/2019/02/11/enter-the-8th-annual-evolution-video-contest/&#34; target=&#34;_blank&#34;&gt;Evolution Film Contest&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;_&lt;/p&gt;

&lt;p&gt;Every year our university opens its doors to high school students, so that they can get an idea of what postgraduates do within each lab. My intention with this video is to open our lab doors to a much wider audience and offer a view into my world as a PhD student studying conservation genetics. I wanted to make a video that is not only fun to watch, but also describes the basic theories and methodologies used within molecular ecology. I also wanted to highlight different sub-divisions of genetics so that viewers can get a sense of the diversity within the field.&lt;/p&gt;

&lt;p&gt;Ultimately my hope is that genetics will not longer be a topic that &amp;ldquo;Students Just Don&amp;rsquo;t Understand&amp;rdquo; * wink wink to my Fresh Prince fans *&lt;/p&gt;

&lt;p&gt;This video could not have happened without the support of my supervisor, fellow lab members, and Stellenbosch University. And special thanks to all those who agreed to wiggle in front of the camera!&lt;/p&gt;

&lt;p&gt;Enjoy and feel free to comment!&lt;/p&gt;

&lt;p&gt;_&lt;/p&gt;


&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//player.vimeo.com/video/338846065&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; webkitallowfullscreen mozallowfullscreen allowfullscreen&gt;&lt;/iframe&gt;
 &lt;/div&gt;

</description>
    </item>
    
    <item>
      <title>A Sustainable Future</title>
      <link>https://esnielsen.github.io/project/sustainability/</link>
      <pubDate>Fri, 07 Sep 2018 16:32:54 +0200</pubDate>
      
      <guid>https://esnielsen.github.io/project/sustainability/</guid>
      <description>&lt;p&gt;The Earth is changing, and rapidly. In the midst of a global pandemic, &lt;a href=&#34;https://climate.nasa.gov/climate_resources/139/video-global-warming-from-1880-to-2020/&#34; target=&#34;_blank&#34;&gt;2020 tied with 2016 as the warmest year ON RECORD&lt;/a&gt;. Ultimately, in order to reduce emissions by 45% by 2030, we will need large corporations and governments to take the lead to ensure that ongoing global development shifts from fossil fuels to renewable energy.&lt;/p&gt;

&lt;p&gt;But while it is mainly a handful of companies that are responsible for 71% of greenhouse gas emissions, we as individuals and consumers can also fight towards and create a more sustainable future. As the lovel figure above by &lt;a href=&#34;http://www.ashleylukashevsky.com/&#34; target=&#34;_blank&#34;&gt;Ashley Lukashevsky&lt;/a&gt; shows, we are all in this together, and together we will rise.&lt;/p&gt;

&lt;p&gt;Therefore, this multi-media post is an ode to small, sustainable actions. And it is important that this is at no means and exhaustive list, and everyone has their own passions and actions that they are attracted to. In the end, the greatest thing we can do is start a conversation on sustainability, as this is the best way to discover new and exciting ways we can transform our society.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;First, here is a fun little song I wrote with the intention spreading the idea of sustainability in a way that is hopefully catchy and creative.&lt;/p&gt;


&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//player.vimeo.com/video/361592712&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; webkitallowfullscreen mozallowfullscreen allowfullscreen&gt;&lt;/iframe&gt;
 &lt;/div&gt;


&lt;hr /&gt;

&lt;p&gt;Probably one of the biggest ways to increase your impact in the fight against climate change is to speak up. Have conversations about climate change, and try to diversify your social circle to learn from those with different views on the climate crisis. You can also reach out to your local NGOs, send letters/emails to your elected officials, and question practices in your workplace.&lt;/p&gt;

&lt;p&gt;Vote!&lt;/p&gt;

&lt;p&gt;I also find this &lt;a href=&#34;https://onlinepublichealth.gwu.edu/how-to-reduce-climate-change/#top&#34; target=&#34;_blank&#34;&gt;nice resource&lt;/a&gt; which has several options to reduce your carbon footprint depending on the time, money, and effort you&amp;rsquo;re willing to spend.&lt;/p&gt;

&lt;p&gt;In addition, indigenous people are &lt;a href=&#34;https://news.trust.org/item/20210420094705-ft6ou&#34; target=&#34;_blank&#34;&gt;arguably the leaders in protecting and conserving natural environments&lt;/a&gt; which are essential to absorb and retain carbon. Thus, you can support indigenous efforts, such as donating movements like &lt;a href=&#34;https://landback.org/donate/&#34; target=&#34;_blank&#34;&gt;LANDBACK&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Then there is the &lt;a href=&#34;https://www.ted.com/talks/leyla_acaroglu_paper_beats_plastic_how_to_rethink_environmental_folklore?language=en&#34; target=&#34;_blank&#34;&gt;TED talk&lt;/a&gt; which I found really interesting, and pointed out many &amp;lsquo;Sustainability Myths&amp;rsquo; that I was previously ignorant of.&lt;/p&gt;

&lt;p&gt;I was also recently ignorant of the CO2 emissions of the internet, until I stumbled upon this lovely &lt;a href=&#34;https://climatecare.org/infographic-the-carbon-footprint-of-the-internet/&#34; target=&#34;_blank&#34;&gt;infographic&lt;/a&gt;. You can also switch your browser from Google to &lt;a href=&#34;https://www.ecosia.org/&#34; target=&#34;_blank&#34;&gt;Ecosia&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;There are also many monetary ways to achieve a lower carbon footprint. One of my favorite new ways is with micro-funding. Find out how you can give micro-loans to green initiatives with &lt;a href=&#34;https://www.kiva.org/&#34; target=&#34;_blank&#34;&gt;Kiva&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;But maybe these actions seem like they will take too much time and energy to implement. No need to fret, the UN has some actions even the laziest of us can do to become more sustainable: find them &lt;a href=&#34;https://www.un.org/sustainabledevelopment/takeaction/&#34; target=&#34;_blank&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Lastly, I would like to end with a quote by Anne Marie Bonneau said, &amp;ldquo;We don&amp;rsquo;t need a handful of people doing zero waste perfectly. We need millions of people doing it imperfectly&amp;rdquo;.&lt;/p&gt;

&lt;p&gt;Thanks for reading!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Representation</title>
      <link>https://esnielsen.github.io/project/respresentation/</link>
      <pubDate>Fri, 07 Sep 2018 16:32:54 +0200</pubDate>
      
      <guid>https://esnielsen.github.io/project/respresentation/</guid>
      <description>&lt;p&gt;Designing Marine Protected Areas, or MPAS, can be difficult, and we still have a lot to learn - as beautifully portrayed in the comic above by &lt;a href=&#34;https://www.ohdakuwaqa.com/&#34; target=&#34;_blank&#34;&gt;Anju Sabu&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;There are complex and dynamic social-ecological systems that need to be weighed and balanced to create an arrangement of MPAs that best protect the natural environment, and provide for various cultural and economic uses of marine resources.&lt;/p&gt;

&lt;p&gt;But, we have come a long way in understanding how to best create this balance, often using spatial planning concepts, which this video by &lt;a href=&#34;https://jenmcgowanresearch.wordpress.com/&#34; target=&#34;_blank&#34;&gt;Jennifer McGowan&lt;/a&gt; does a superb job at explaining:&lt;/p&gt;


&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/1IDeKJJO7s8&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;


&lt;p&gt;However, as scientists, we often like to take simple concepts like targeting representation in MPAs, and make it more complex.&lt;/p&gt;

&lt;p&gt;This is described in an Epistle by the conservation planning guru &lt;a href=&#34;http://possinghamlab.org/&#34; target=&#34;_blank&#34;&gt;Prof Hugh Possingham&lt;/a&gt;:&lt;/p&gt;

&lt;p&gt;__&lt;/p&gt;

&lt;p&gt;&amp;ldquo;The Lame-duck Conservation Principle&lt;/p&gt;

&lt;p&gt;Remember the good old days when conservation planning was just two main principles – adequacy and representation?  It seems so simple and logical. But at some point we lost sight of the importance of representation, the simple notion of protecting a sample of everything in a well-managed protected area. What happened?&lt;/p&gt;

&lt;p&gt;In theory, representation is still at the top of the international conservation agenda, it gets a solid mention in Aichi Target 11, which states:&lt;/p&gt;

&lt;p&gt;&amp;lsquo;By 2020, at least 17 percent of terrestrial and inland water areas and 10 percent of coastal and marine areas, especially areas of particular importance for biodiversity and ecosystem services, are conserved through effectively and equitably managed, ecologically representative and well-connected systems of protected areas and other effective area-based conservation measures, and integrated into the wider landscape and seascape.&amp;rsquo;&lt;/p&gt;

&lt;p&gt;The Nature Conservancy has championed the cause of representation, with representation and resilience forming the core principles of our new protect land and water strategy. But the rest of the world seems to have lost interest.&lt;/p&gt;

&lt;p&gt;In my simple mind, The Nature Conservancy is the &amp;lsquo;habitat organisation.&amp;rsquo; That is why I joined.  We focus on how to make more quality habitat, in all its forms, because it delivers benefits for people and nature.  So it is only logical that we always return to a strong focus on habitat representation.&lt;/p&gt;

&lt;p&gt;Yet while we continue to keep our eye on the ball, some organisations and groups believe that a focus on threatened species, via Key Biodiversity Areas, is the best way to prioritisation protection.  Others are pushing connectivity as the most important conservation principle — let’s connect the Yukon to Yellowstone.  I agree that both are important, but still very much secondary to the notion of protecting a representative sample of habitats or ecosystems.&lt;/p&gt;

&lt;p&gt;Why are we losing this marketing campaign?  In my opinion, representation is on the backburner because it is intellectually a little dull.  Connectivity captures the imagination of many scientists, it can be measured by 100 different metrics, while ideas like &amp;lsquo;corridors&amp;rsquo; seem to capture the hearts and minds of the public and politicians.  I love connectivity, but I am convinced it is a secondary issue. And, of course, threatened species are all so sexy — with their big brown eyes— much sexier than a place like the mallee woodland (my favourite habitat in Australia).&lt;/p&gt;

&lt;p&gt;So here’s my challenge to you:  Representation is the most boring but important concept in conservation. So how to we make it sexy again?&amp;rdquo;&lt;/p&gt;

&lt;p&gt;__&lt;/p&gt;

&lt;p&gt;I have been thinking of Prof Possingham&amp;rsquo;s question of how do we make the simple act of targeting representation sexy - and I think the answer comes down to making representation a surrogate for adaptability.&lt;/p&gt;

&lt;p&gt;I would argue that nothing is sexier in conservation science at the moment than prioritising areas that are more resilient to climate change. My work specifically looks at areas that are more genetically diverse, and thus assumed to be more resilient to environmental change. And interestingly, there have been several recent publications that suggest that by representing different habitat types (or different species distributions), you are also capturing genetic diversity.&lt;/p&gt;

&lt;p&gt;You can find such papers in the links below:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://onlinelibrary.wiley.com/doi/pdf/10.1111/ddi.12195&#34; target=&#34;_blank&#34;&gt;Geographical surrogates of genetic variation for selecting island populations for conservation&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://www.pnas.org/content/pnas/114/48/12755.full.pdf&#34; target=&#34;_blank&#34;&gt;Environmental and geographic variables are effective surrogates for genetic variation in conservation planning&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://onlinelibrary.wiley.com/doi/pdf/10.1111/j.1472-4642.2011.00752.x&#34; target=&#34;_blank&#34;&gt;Incorporating evolutionary processes into conservation planning using species distribution data: a case study with the western Mediterranean herpetofauna: Evolutionary processes in conservation planning&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://onlinelibrary.wiley.com/doi/pdf/10.1111/ddi.12113&#34; target=&#34;_blank&#34;&gt;Testing large-scale conservation corridors designed for patterns and processes: comparative phylogeography of three tree species&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;But of course, this is science, so here is this paper arguing the opposite:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1365-294X.2008.04039.x&#34; target=&#34;_blank&#34;&gt;On the validity of habitat as a predictor of genetic structure in aquatic systems: a comparative study using California water beetles&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I think the argument of representative habitats as surrogates of species and genetic diversity could help bring this elegant practice back in the forefront of conservation planning, but I think it will also require scientists to change our perspective of our work, as to not think about how well our work will publish, but how well it can be applied to &amp;lsquo;real-world&amp;rsquo; conservation practice.&lt;/p&gt;

&lt;p&gt;So really we need a whole paradigm shift within Academia&amp;hellip; but for now let&amp;rsquo;s just settle with a haiku about representation in conservation planning:&lt;/p&gt;

&lt;p&gt;~&lt;/p&gt;

&lt;p&gt;MPA designs,&lt;/p&gt;

&lt;p&gt;To make easier target:&lt;/p&gt;

&lt;p&gt;Representation&lt;/p&gt;

&lt;p&gt;~&lt;/p&gt;

&lt;p&gt;Thanks for reading!&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
